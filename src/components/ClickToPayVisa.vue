<template>
  <div>
    <div id="buttonPaymentListContainer"></div>
    <textarea id="transientToken" name="transientToken" rows="25" cols="50"></textarea>
  </div>
</template>

<script setup>
import { onMounted } from 'vue';

const loadVisaClickToPay = async () => {
  console.log('Cargando script de VISA Click to Pay...');
  const script = document.createElement('script');
  script.src = 'https://apitest.cybersource.com/up/v1/assets/0.22.0/SecureAcceptance.js'; // clientLibrary obtenido de la captura de contexto
  script.async = true;
  script.onload = await onVisaClickToPayLoaded;
  script.onerror = function() {
    console.error('Error al cargar el script de VISA Click to Pay.');
  };
  document.head.appendChild(script);
};

const onVisaClickToPayLoaded = async () => {
  const captureContext = 'eyJraWQiOiJ6dSIsImFsZyI6IlJTMjU2In0.eyJmbHgiOnsicGF0aCI6Ii9mbGV4L3YyL3Rva2VucyIsImRhdGEiOiJBQ1E0VjVKTVhtS1lKNThwZHZTeDF4QUFFSGNwWkFkSzkyeGY4RmUzZTBaMncwbThCeUg5UDlJcm52b2xGSmZvdG5GMWhXdFJ5QVFJbWlncUI2Nk55VnRYNEplUHZQZTNrRmVxbXJIN1hGUlJPRVdEdDBYeElTZnV0ckx0NTZzditZdkhPVFlhUHhtR0pYMjJtNnRqdWt4R21RXHUwMDNkXHUwMDNkIiwib3JpZ2luIjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20iLCJ0cmFuc2llbnRUb2tlbk9wZXJhdGlvbnMiOlt7InN1YiI6InRlc3RnZXRuZXRjbF9zYW5kYm94MDAxIiwiYXVkIjoiZ2V0bmV0Y2xfc2FuZGJveCIsImtpZCI6ImUwNDQ5YWU4LTUxZDgtNDQ0MC1iN2IzLWJiODQxYWYzNjIwMiIsInR5cGUiOiJTVE9SRSJ9XSwiandrIjp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwibiI6InhvU3VHLUt3aUJjY0FxRVVhWjRpajJPY1h3VFViUUJudHlsVFc1MjNTNWNRXzllUTlNeF82YWZVTWFMZm5CaVpMZndoYk9kV2hkM3gtX191NXU4T3JWSUdIdkN4U2R1RElaX1VaR3daZ1ZkREduZ3EzYW9lZnBodjRoNmVUSFd0TEtSSVVUYkFILTdkQ2pnSDlpRExUZGU0UHhSUXNhOVFPRVhJdzcxSEQ4SXhjbDBmUHpKbm9nNGlSa25DTTc1STJDb2ZDcERVd19VTlh2OTBaSnNUd3draWFFTXZMUm94UlhiSDVRU3pncWJFYUhGTlBnelRycl9MOG9US3hxMWVBNWZCNXVkOUdNNHZWcjlCMThkdTk4QkE1b1g3TUZ5N1lVTDhwNWRWS194VzhENWxsNmpHSkVUZ05sZjNuSWVaTkRfYVZnNGZsdmI0OFVPZF9iYW1aUSIsImtpZCI6IjA4VXdRdXRpUGJWeG5nOUVRVmZuWXlFVlZBZXZhd2hRIn19LCJjdHgiOlt7ImRhdGEiOnsiYWxsb3dlZFBheW1lbnRUeXBlcyI6W3sicGFnZSI6MSwidHlwZSI6IkNMSUNLVE9QQVkifSx7InBhZ2UiOjIsInR5cGUiOiJTUkNWSVNBIn0seyJwYWdlIjozLCJ0eXBlIjoiU1JDTUFTVEVSQ0FSRCJ9LHsicGFnZSI6NCwidHlwZSI6IlNSQ0FNRVgifSx7InBhZ2UiOjUsInR5cGUiOiJQQU5FTlRSWSJ9XSwicGF5bWVudENvbmZpZ3VyYXRpb25zIjp7IlNSQ1ZJU0EiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LWFzc2V0cy5zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20iLCJwYXRoIjoiL2NoZWNrb3V0LXdpZGdldC9yZXNvdXJjZXMvanMvc3JjLWktYWRhcHRlci92aXNhU2RrLmpzP3YyIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjNHUFdQVkkzRVNXM0dDSlMyWTVGMTNhZVVZbEtUVlRoWGlTMlRLbllLRXRMbC1RRU0iLCJuIjoic1pQSXVzRGY3eVFubmhCa1U5bXUxNFZPTzNDcnVpM2I3ckFmMktZZW9iVVJtWEExN2IxSlg5amcwQ2QtdmdwbXV5VHJ4QlVTYy00YjAtVVBnU3dHRnFQV1VweDA4RXhxcndQRE92Rm9qQm91MndseXE4YmN5MFVzLUJmZUN6U0U1bE1WZFNYVFhYWGNOcXUtcWIyMmpDQ0NKQUxweHNBcnNib01PWHNMZWRoM000WE5RNVhHQXRSZjdiLS11VFk1RHI5S0xZeVV2WktBblkwNE1LSlBFTzU0WWlJRk01RFRBaE5PbXMwODlqZE1keC1VUklLSmpQVTItUnBIRzF1OExDRzAyOFJUSXBQc05iUmFudVM1VEFZX3pseERnYjFoS0ozNlliWkVOSExnOVBYVEJoZE9NbFU5MERUTGxmY2JMVGEtRDdEZ2xqQWFXQ3V2ekxQYUd3In0sInBhcmFtZXRlcnMiOnsic3JjSW5pdGlhdG9ySWQiOiJKRkNaOFFWT0pBNzZOWFo2OEZaRDIxUllJeGozeVBaZGlVeGtkTnVpYkJseGd3YVA0Iiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjaVRyYW5zYWN0aW9uSWQiOiIyN2NiYzcyYi00YmI2LTRmYTMtYjM2My1mODY3ZGEyOTYwNzYiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsiZHBhTG9jYWxlIjoiZW5fVVMiLCJwYXlsb2FkVHlwZUluZGljYXRvciI6IkZVTEwiLCJyZXZpZXdBY3Rpb24iOiJjb250aW51ZSIsImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJDTyJdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IkFMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6Ik5PTkUiLCJjb25zdW1lck5hbWVSZXF1ZXN0ZWQiOnRydWUsImNvbnN1bWVyRW1haWxBZGRyZXNzUmVxdWVzdGVkIjpmYWxzZSwiY29uc3VtZXJQaG9uZU51bWJlclJlcXVlc3RlZCI6dHJ1ZSwibWVyY2hhbnRDb3VudHJ5Q29kZSI6IlVTIiwiY3VzdG9tSW5wdXREYXRhIjp7ImNoZWNrb3V0T3JjaGVzdHJhdG9yIjoibWVyY2hhbnQifSwidHJhbnNhY3Rpb25BbW91bnQiOnsidHJhbnNhY3Rpb25BbW91bnQiOiIyMS4wMCIsInRyYW5zYWN0aW9uQ3VycmVuY3lDb2RlIjoiVVNEIn0sInBheW1lbnRPcHRpb25zIjp7ImRwYUR5bmFtaWNEYXRhVHRsTWludXRlcyI6MTUsImRwYVBhblJlcXVlc3RlZCI6ZmFsc2UsImR5bmFtaWNEYXRhVHlwZSI6IkNBUkRfQVBQTElDQVRJT05fQ1JZUFRPR1JBTV9MT05HX0ZPUk0ifX19fSwiU1JDTUFTVEVSQ0FSRCI6eyJvcmlnaW4iOiJodHRwczovL3NhbmRib3guc3JjLm1hc3RlcmNhcmQuY29tIiwicGF0aCI6Ii9zZGsvc3Jjc2RrLm1hc3RlcmNhcmQuanMiLCJwYW5FbmNyeXB0aW9uS2V5Ijp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwia2lkIjoiMjAyMzAyMDcyMjM1MjEtc2FuZGJveC1mcGFuLWVuY3J5cHRpb24tc3JjLW1hc3RlcmNhcmQtaW50Iiwia2V5X29wcyI6WyJlbmNyeXB0Iiwid3JhcEtleSJdLCJhbGciOiJSU0EtT0FFUC0yNTYiLCJuIjoidDA2SThzamxTLXJyczd1Q2FnSDhldm9ldW1hUm92S3ppWlNJOVMyTjlJRFE5dFcyUGFwZlJhOUxjMUt2ZUVCRFZzMjdQa2hrVTVPeUhnUDBpRWpUdUtWcHZoNTlUNGxhLW1CU0lsczdVZWNVUUxMYTBXa21idEw3ak5kbHRBNWZxN0FoY0FyNXFjYTk4OHFyTGQ3SXlyOUUwQzNUeGJUOXRvMWlRY3B6OG9jWk9EUlhvaWRGQW5PVkw1WUdGbWxzcmVEYko0VmhzaTBwQWRjY1FjaWwteWRTZ3VyS0ItcnFLcHBiOWVwb211NFFVaDMzODJDdjhOb2JZbUYzb3M4bkdHZ0dQLWN5WG8wbnNLY1BBZ2ZybFF6b3M3cUh4VU9yRmUyeF9sWjFHMUFFLVhya3J4akJ5czlxNTNHTVJTTkNROGMtX21jRjlwYnE0SFlCcy12RDVRIn0sInBhcmFtZXRlcnMiOnsic3JjaVRyYW5zYWN0aW9uSWQiOiIyN2NiYzcyYi00YmI2LTRmYTMtYjM2My1mODY3ZGEyOTYwNzYiLCJzcmNpRHBhSWQiOiJhMDFlZTIwZS1hNmU4LTQyNzgtYjRkZi05MTUyMmYzMjg4ODciLCJzcmNJbml0aWF0b3JJZCI6Ijg0NGY3ZTNkLTA3ZjAtNDRiMS1hMjM3LWU2NDI0NDRlMDUxMiIsImRwYVRyYW5zYWN0aW9uT3B0aW9ucyI6eyJ0cmFuc2FjdGlvblR5cGUiOiJQVVJDSEFTRSIsImRwYUxvY2FsZSI6ImVuX1VTIiwiZHBhQWNjZXB0ZWRTaGlwcGluZ0NvdW50cmllcyI6WyJVUyIsIkNPIl0sImNvbnN1bWVyRW1haWxBZGRyZXNzUmVxdWVzdGVkIjpmYWxzZSwiY29uc3VtZXJQaG9uZU51bWJlclJlcXVlc3RlZCI6dHJ1ZSwidHJhbnNhY3Rpb25BbW91bnQiOnsidHJhbnNhY3Rpb25BbW91bnQiOiIyMS4wMCIsInRyYW5zYWN0aW9uQ3VycmVuY3lDb2RlIjoiVVNEIn0sImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUJpbGxpbmdQcmVmZXJlbmNlIjoiRlVMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6Ik5PTkUiLCJjb25zdW1lck5hbWVSZXF1ZXN0ZWQiOnRydWUsInBheWxvYWRUeXBlSW5kaWNhdG9yIjoiRlVMTCIsInBheW1lbnRPcHRpb25zIjp7ImR5bmFtaWNEYXRhVHlwZSI6IkNBUkRfQVBQTElDQVRJT05fQ1JZUFRPR1JBTV9TSE9SVF9GT1JNIn19fX0sIlNSQ0FNRVgiOnsib3JpZ2luIjoiaHR0cHM6Ly9xd3d3LmFleHAtc3RhdGljLmNvbSIsInBhdGgiOiIvYWthbWFpL3JlbW90ZWNvbW1lcmNlL3NjcmlwdHMvYW1leFNESy0xLjAuMC5qcyIsInBhbkVuY3J5cHRpb25LZXkiOnsia3R5IjoiUlNBIiwiZSI6IkFRQUIiLCJ1c2UiOiJlbmMiLCJraWQiOiJzcmMtYW1leC1jYXJkLWVuYy0yMDI1IiwiYWxnIjoiUlNBLU9BRVAtMjU2IiwibiI6InZNS0IzNkl1a3pvd2pCSVV2LTFDUkxOcjJPcnZoX1NCbU9YV2swUVVJdW0yYmN6cEFFbFBFV3Z0djJRN245SzFhTjh2elloM01ZeUduSDY4YXY0Q1J4b054OFBZVklPZWZOM0hyVU1NUkNzNzRQc2NkcE00TU5VaHBmSF9TVmFsdjNLWUZSRGFaeGZvY2UxRERRVVRkcjRyWFJyOW9XNGlRSVZkX2ZKTkJpTElVN2ZtU0hEZGs3bFZxUWdoYVBMSlhUQzZ4elF6a2phM0FQdm5ma2VYRlV2aVVYNnZ3cW4yYkxDaldnSFZjZDFucktNTmpTMU4yaXdrMFF3WmVuZGx5clRIcGU1NXdhSDhseGdsaVBFTlc1SHpnZDUwUUd6RU1panFCd01VRndFalVidW1rZndSNHZQay1HNUF2U3NCVG5JRWJXWE81WmtqeWltQWYtM09LYjRoYkRFUS14enM4bGpBUE1RT0p5MEI5dXJfOEVfVDhXRHRHODhxcVZkY2xwRlZtSERycWJqc2NUUGNpNGRkQWRxVi1wcHdCczcwNDJjbDNpdEVab05wSjl5cU81T0tzY21jS2pTMUpIbGxlaVlDMjQ4dzVxM1BYWHJfUDNTT2ppdFdsaS1vT2xPdENZSF8ycTBFczZSbndkekNIT1U4WFpPd2tJdmNoUUFEIn0sInBhcmFtZXRlcnMiOnsic3JjaVRyYW5zYWN0aW9uSWQiOiIyN2NiYzcyYi00YmI2LTRmYTMtYjM2My1mODY3ZGEyOTYwNzYiLCJzcmNJbml0aWF0b3JJZCI6IjhlYzJjODg4LTY0Y2MtNGVmYy05MTc1LWIzMzc0NTJiMjhjOCIsImRwYURhdGEiOnsiZHBhTmFtZSI6IkdFVE5FVCBDSElMRSBTLkEuIiwiZHBhTG9nb1VyaSI6Imh0dHBzOi8vd3d3LmdldG5ldC5jbC8iLCJkcGFQcmVzZW50YXRpb25OYW1lIjoiR0VUTkVUIENISUxFIFMuQS4iLCJkcGFVcmkiOiJodHRwczovL3d3dy5nZXRuZXQuY2wvIn0sImRwYVRyYW5zYWN0aW9uT3B0aW9ucyI6eyJkcGFMb2NhbGUiOiJlbl9VUyIsImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJDTyJdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IkFMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6Ik5PTkUiLCJjb25zdW1lck5hbWVSZXF1ZXN0ZWQiOnRydWUsImNvbnN1bWVyRW1haWxBZGRyZXNzUmVxdWVzdGVkIjpmYWxzZSwiY29uc3VtZXJQaG9uZU51bWJlclJlcXVlc3RlZCI6dHJ1ZSwicmV2aWV3QWN0aW9uIjoiY29udGludWUiLCJ0aHJlZURzUHJlZmVyZW5jZSI6Ik5PTkUifX19fSwiY2FwdHVyZU1hbmRhdGUiOnsiYmlsbGluZ1R5cGUiOiJGVUxMIiwicmVxdWVzdEVtYWlsIjpmYWxzZSwicmVxdWVzdFBob25lIjp0cnVlLCJyZXF1ZXN0U2hpcHBpbmciOmZhbHNlLCJzaGlwVG9Db3VudHJpZXMiOlsiVVMiLCJDTyJdLCJzaG93QWNjZXB0ZWROZXR3b3JrSWNvbnMiOnRydWV9LCJvcmRlckluZm9ybWF0aW9uIjp7ImFtb3VudERldGFpbHMiOnsidG90YWxBbW91bnQiOiIyMS4wMCIsImN1cnJlbmN5IjoiVVNEIn0sImJpbGxUbyI6eyJhZGRyZXNzMSI6IjExMTEgUGFyayBTdHJlZXQiLCJhZGRyZXNzMiI6IkFwYXJ0bWVudCAyNEIiLCJhZG1pbmlzdHJhdGl2ZUFyZWEiOiJOWSIsImJ1aWxkaW5nTnVtYmVyIjoiMSIsImNvdW50cnkiOiJVUyIsImRpc3RyaWN0IjoiZGlzdHJpY3QiLCJsb2NhbGl0eSI6Ik5ldyBZb3JrIiwicG9zdGFsQ29kZSI6IjAwMDAwIiwiY29tcGFueSI6eyJhZGRyZXNzMSI6IjkwMCBNZXRybyBDZW50ZXIgQmx2ZCIsImFkbWluaXN0cmF0aXZlQXJlYSI6IkNBIiwiYnVpbGRpbmdOdW1iZXIiOiIxIiwiY291bnRyeSI6IlVTIiwiZGlzdHJpY3QiOiJkaXN0cmljdCIsImxvY2FsaXR5IjoiRm9zdGVyIENpdHkiLCJwb3N0YWxDb2RlIjoiOTQ0MDQiLCJuYW1lIjoiVmlzYSBJbmMifSwiZW1haWwiOiJtYXlhLnRyYW5AY29tcGFueS5jb20iLCJmaXJzdE5hbWUiOiJNYXlhIiwibGFzdE5hbWUiOiJUcmFuIiwibWlkZGxlTmFtZSI6IlMiLCJ0aXRsZSI6Ik1zIiwicGhvbmVOdW1iZXIiOiIxMjM0NTY3ODkwIiwicGhvbmVUeXBlIjoicGhvbmVUeXBlIn0sInNoaXBUbyI6eyJhZGRyZXNzMSI6IlZpc2EiLCJhZGRyZXNzMiI6IjEyMyBNYWluIFN0cmVldCIsImFkZHJlc3MzIjoiQXBhcnRtZW50IDEwMiIsImFkbWluaXN0cmF0aXZlQXJlYSI6IkNBIiwiYnVpbGRpbmdOdW1iZXIiOiJzdHJpbmciLCJjb3VudHJ5IjoiVVMiLCJkaXN0cmljdCI6ImRpc3RyaWN0IiwibG9jYWxpdHkiOiJGb3N0ZXIgQ2l0eSIsInBvc3RhbENvZGUiOiI5NDQwNCIsImZpcnN0TmFtZSI6IkpvZSIsImxhc3ROYW1lIjoiU29hcCJ9fSwidGFyZ2V0T3JpZ2lucyI6WyJodHRwczovL3BvYy1sZW1vbi1maXZlLnZlcmNlbC5hcHAiXSwiaWZyYW1lcyI6eyJtY2UiOiIvbWNlL21jZS5odG1sIiwiYnV0dG9ucyI6Ii9idXR0b25saXN0L2J1dHRvbmxpc3QuaHRtbCIsInNyYyI6Ii9zZWN1cmUtcmVtb3RlLWNvbW1lcmNlL3NyYy5odG1sIiwiY3RwIjoiL2N0cC9jdHAuaHRtbCIsImdvb2dsZXBheSI6Ii9nb29nbGVwYXkvZ29vZ2xlcGF5Lmh0bWwiLCJhcHBsZXBheSI6Ii9hcHBsZXBheS9hcHBsZXBheS5odG1sIiwicGF6ZSI6Ii9wYXplL3BhemUuaHRtbCIsImNoZWNrIjoiL2NoZWNrL2NoZWNrLmh0bWwifSwiY2xpZW50VmVyc2lvbiI6IjAuMTkiLCJjb3VudHJ5IjoiVVMiLCJsb2NhbGUiOiJlbl9VUyIsImFsbG93ZWRDYXJkTmV0d29ya3MiOlsiVklTQSIsIk1BU1RFUkNBUkQiLCJBTUVYIl0sImNyIjoiTnZWeUI5NFY5TnhnVEtfX1dkSVYtTGRrYnF4Ukc0WS12SDF5VmxZOEx3d0R1RHFTMkIyOEhXTjEySWxaNkVhQWlQZVNIeHU2NmRBMjFuWjVwVFZCLVNnRFFVX0tmUTJXQVJFdmxSZHBxamVkcFBBWElzVHotdzFHIiwic2VydmljZU9yaWdpbiI6Imh0dHBzOi8vYXBpdGVzdC5jeWJlcnNvdXJjZS5jb20iLCJjbGllbnRMaWJyYXJ5IjoiaHR0cHM6Ly9hcGl0ZXN0LmN5YmVyc291cmNlLmNvbS91Yy92MS9hc3NldHMvMC4xOS40L1NlY3VyZUFjY2VwdGFuY2UuanMiLCJsb2dnaW5nUGF0aCI6Ii91Yy92MS9sb2ctZXZlbnRzIiwiYXNzZXRzUGF0aCI6Ii91Yy92MS9hc3NldHMvMC4xOS40IiwiY2xpZW50TGlicmFyeUludGVncml0eSI6InNoYTI1Ni1mWmN6dGJvdCtMOVdmNGxEMWU0M0QyZE5uMDdKczZJbUs5MlY1NWllQXlFXHUwMDNkIn0sInR5cGUiOiJnZGEtMC45LjAifV0sImlzcyI6IkZsZXggQVBJIiwiZXhwIjoxNzM0OTg4MjMzLCJpYXQiOjE3MzQ5ODczMzMsImp0aSI6IlhxSzNGOTBrMlJycTZ5RWUifQ.CmwJtcrYfDKiO6QyhDpONlb_PKeqUqyrq79hau9MiCRNE9b3uGsOhwUZ3d5rZHUusX17UjLYUtIqoW8mdikXqu8dFGksKjRpZwxZeAfwhmI4xkOu0WNmnRTJ4HVGnXYcueEuqqbwgZ1t9gK_mwq-Dpz2YPdj1JUwBbPht8-3nM1dnc93jhac87xXj2FkpImnLN4ZlRc0JKOoyZJULZHkk1UpwsWQ41bOVtfy6y4lR3kUcsTveBMzOpyyDIYPCtj7SjuiJZxQaRQS6SaqerQULtPd33H91hfWr2D1EDfG-QtXbfaLXe4oA9eGd8flkruqYmq0UozrPgCkdk62_w49fQ';
  const showArgs = {
    containers: {
      paymentSelection: "#buttonPaymentListContainer"
    }
  };

  Accept(captureContext)
      .then(accept => accept.unifiedPayments())
      .then(up => up.show(showArgs))
      .then(tt => {
        const transientToken = document.getElementById('transientToken');
        transientToken.value = tt;

        console.log('tt:', tt);
      })
      .catch(error => {
        console.error("Error en el flujo de Click to Pay:", error);
      });

  console.log('cargado script de VISA Click to Pay');
};

onMounted(() => {
  console.log('Actualizado el 23 de dic a las 03:55 pm')
  loadVisaClickToPay();
});
</script>
