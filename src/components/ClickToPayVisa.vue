<template>
  <div>
    <div class="px-4 border w-1/2 h-16" id="buttonPaymentListContainer"></div>
    <textarea class="my-5" id="transientToken" name="transientToken" rows="25" cols="50"></textarea>
  </div>
</template>

<script setup>
import { onMounted } from 'vue';

const loadVisaClickToPay = async () => {
  console.log('Cargando script de VISA Click to Pay...');
  const script = document.createElement('script');
  script.src = 'https://apitest.cybersource.com/up/v1/assets/0.22.0/SecureAcceptance.js'; // clientLibrary obtenido de la captura de contexto
  script.async = true;
  script.onload = await onVisaClickToPayLoaded;
  script.onerror = function() {
    console.error('Error al cargar el script de VISA Click to Pay.');
  };
  document.head.appendChild(script);
};

const onVisaClickToPayLoaded = async () => {
  const captureContext = 'eyJraWQiOiJ6dSIsImFsZyI6IlJTMjU2In0.eyJmbHgiOnsicGF0aCI6Ii9mbGV4L3YyL3Rva2VucyIsImRhdGEiOiJMNnNJRDhxbXVSVGovQVRQZkR6ZVlCQUFFSS9ydmxTVTZIcDFYZlo2bUtvUWpGTTI3dFkvQWZXdFRhc3gvSzFHZFFUdnpEcG42Y01aQUowUjlsRWUyU2p6VkFNQUhWUklWWTNFL1ZsT21GamoxenVsOVJRaGIwb0RLQTIzMDdXT0NYK3FvN0xDTmxyWld3dm5JUGptemVkUUVBXHUwMDNkXHUwMDNkIiwib3JpZ2luIjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20iLCJ0cmFuc2llbnRUb2tlbk9wZXJhdGlvbnMiOlt7InN1YiI6InRlc3RnZXRuZXRjbF9zYW5kYm94MDAxIiwiYXVkIjoiZ2V0bmV0Y2xfc2FuZGJveCIsImtpZCI6ImUwNDQ5YWU4LTUxZDgtNDQ0MC1iN2IzLWJiODQxYWYzNjIwMiIsInR5cGUiOiJTVE9SRSJ9XSwiandrIjp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwibiI6IjNjOTZzMUZvcUpYSnVkRzlZOUt2emt6YkVMdDZwSEhwQ1RXYTJtUFktbWpHNGVJOC1oeDh0OHo2VHhyZm5nZGdORVZ0cWN5ek1tZFp5a0h2dUhMcnNiM2laZldDcFpVeDNmNHgzQ2hGWG1pa09YV09xMDE0UkczYUttYnI5QW82REZUZzNGMUJpWFNBeC1XdmFKYXVLR0tTMFpiVXBHQURscEU4Y0pPM2RIZTNfSG9ETnBXLXpucEdYcXYzQ2ZtX0NMNm1yeWNVQ2hlWXdPdDhneE9DMjZ1Wk52WEhBajVtUzFFV2hTMnB4ZzNMZGcwSGV4WVJaRTg1VjItSXQtNldnc251VmJPYnBldm00aFd2bDJzZWdSdDM5MGgxMDFjX2xXUlREUjBvbWJHaGxRbzlPcjBXRjV5MzUyZ1plWUJoazJCckdkcHBaMkM4Qi1UV1NtQ1YwUSIsImtpZCI6IjA4bjFYa25sZnlBVGZrSXBRUzVpUEFrWUlYN2VZZzRLIn19LCJjdHgiOlt7ImRhdGEiOnsiYWxsb3dlZFBheW1lbnRUeXBlcyI6W3sicGFnZSI6MSwidHlwZSI6IkNMSUNLVE9QQVkifSx7InBhZ2UiOjIsInR5cGUiOiJTUkNWSVNBIn0seyJwYWdlIjozLCJ0eXBlIjoiU1JDTUFTVEVSQ0FSRCJ9LHsicGFnZSI6NCwidHlwZSI6IlNSQ0FNRVgifSx7InBhZ2UiOjUsInR5cGUiOiJQQU5FTlRSWSJ9XSwicGF5bWVudENvbmZpZ3VyYXRpb25zIjp7IlNSQ1ZJU0EiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LWFzc2V0cy5zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20iLCJwYXRoIjoiL2NoZWNrb3V0LXdpZGdldC9yZXNvdXJjZXMvanMvc3JjLWktYWRhcHRlci92aXNhU2RrLmpzP3YyIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjNHUFdQVkkzRVNXM0dDSlMyWTVGMTNhZVVZbEtUVlRoWGlTMlRLbllLRXRMbC1RRU0iLCJuIjoic1pQSXVzRGY3eVFubmhCa1U5bXUxNFZPTzNDcnVpM2I3ckFmMktZZW9iVVJtWEExN2IxSlg5amcwQ2QtdmdwbXV5VHJ4QlVTYy00YjAtVVBnU3dHRnFQV1VweDA4RXhxcndQRE92Rm9qQm91MndseXE4YmN5MFVzLUJmZUN6U0U1bE1WZFNYVFhYWGNOcXUtcWIyMmpDQ0NKQUxweHNBcnNib01PWHNMZWRoM000WE5RNVhHQXRSZjdiLS11VFk1RHI5S0xZeVV2WktBblkwNE1LSlBFTzU0WWlJRk01RFRBaE5PbXMwODlqZE1keC1VUklLSmpQVTItUnBIRzF1OExDRzAyOFJUSXBQc05iUmFudVM1VEFZX3pseERnYjFoS0ozNlliWkVOSExnOVBYVEJoZE9NbFU5MERUTGxmY2JMVGEtRDdEZ2xqQWFXQ3V2ekxQYUd3In0sInBhcmFtZXRlcnMiOnsic3JjSW5pdGlhdG9ySWQiOiJKRkNaOFFWT0pBNzZOWFo2OEZaRDIxUllJeGozeVBaZGlVeGtkTnVpYkJseGd3YVA0Iiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjaVRyYW5zYWN0aW9uSWQiOiI3ZDg4MzU4NS02NzI3LTQ5ZmYtOTYxYy1mZWQyYWE5YTUzMzQiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsiZHBhTG9jYWxlIjoiZXNfQ0wiLCJwYXlsb2FkVHlwZUluZGljYXRvciI6IkZVTEwiLCJyZXZpZXdBY3Rpb24iOiJjb250aW51ZSIsImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJHQiJdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IlBPU1RBTF9DT1VOVFJZIiwiZHBhU2hpcHBpbmdQcmVmZXJlbmNlIjoiTk9ORSIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwiY29uc3VtZXJFbWFpbEFkZHJlc3NSZXF1ZXN0ZWQiOmZhbHNlLCJjb25zdW1lclBob25lTnVtYmVyUmVxdWVzdGVkIjpmYWxzZSwibWVyY2hhbnRDb3VudHJ5Q29kZSI6IkNMIiwiY3VzdG9tSW5wdXREYXRhIjp7ImNoZWNrb3V0T3JjaGVzdHJhdG9yIjoibWVyY2hhbnQifSwidHJhbnNhY3Rpb25BbW91bnQiOnsidHJhbnNhY3Rpb25BbW91bnQiOiIyMDAwMCIsInRyYW5zYWN0aW9uQ3VycmVuY3lDb2RlIjoiQ09QIn0sInBheW1lbnRPcHRpb25zIjp7ImRwYUR5bmFtaWNEYXRhVHRsTWludXRlcyI6MTUsImRwYVBhblJlcXVlc3RlZCI6ZmFsc2UsImR5bmFtaWNEYXRhVHlwZSI6IkNBUkRfQVBQTElDQVRJT05fQ1JZUFRPR1JBTV9MT05HX0ZPUk0ifX19fSwiU1JDTUFTVEVSQ0FSRCI6eyJvcmlnaW4iOiJodHRwczovL3NhbmRib3guc3JjLm1hc3RlcmNhcmQuY29tIiwicGF0aCI6Ii9zZGsvc3Jjc2RrLm1hc3RlcmNhcmQuanMiLCJwYW5FbmNyeXB0aW9uS2V5Ijp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwia2lkIjoiMjAyMzAyMDcyMjM1MjEtc2FuZGJveC1mcGFuLWVuY3J5cHRpb24tc3JjLW1hc3RlcmNhcmQtaW50Iiwia2V5X29wcyI6WyJlbmNyeXB0Iiwid3JhcEtleSJdLCJhbGciOiJSU0EtT0FFUC0yNTYiLCJuIjoidDA2SThzamxTLXJyczd1Q2FnSDhldm9ldW1hUm92S3ppWlNJOVMyTjlJRFE5dFcyUGFwZlJhOUxjMUt2ZUVCRFZzMjdQa2hrVTVPeUhnUDBpRWpUdUtWcHZoNTlUNGxhLW1CU0lsczdVZWNVUUxMYTBXa21idEw3ak5kbHRBNWZxN0FoY0FyNXFjYTk4OHFyTGQ3SXlyOUUwQzNUeGJUOXRvMWlRY3B6OG9jWk9EUlhvaWRGQW5PVkw1WUdGbWxzcmVEYko0VmhzaTBwQWRjY1FjaWwteWRTZ3VyS0ItcnFLcHBiOWVwb211NFFVaDMzODJDdjhOb2JZbUYzb3M4bkdHZ0dQLWN5WG8wbnNLY1BBZ2ZybFF6b3M3cUh4VU9yRmUyeF9sWjFHMUFFLVhya3J4akJ5czlxNTNHTVJTTkNROGMtX21jRjlwYnE0SFlCcy12RDVRIn0sInBhcmFtZXRlcnMiOnsic3JjaVRyYW5zYWN0aW9uSWQiOiI3ZDg4MzU4NS02NzI3LTQ5ZmYtOTYxYy1mZWQyYWE5YTUzMzQiLCJzcmNpRHBhSWQiOiJhMDFlZTIwZS1hNmU4LTQyNzgtYjRkZi05MTUyMmYzMjg4ODciLCJzcmNJbml0aWF0b3JJZCI6Ijg0NGY3ZTNkLTA3ZjAtNDRiMS1hMjM3LWU2NDI0NDRlMDUxMiIsImRwYVRyYW5zYWN0aW9uT3B0aW9ucyI6eyJ0cmFuc2FjdGlvblR5cGUiOiJQVVJDSEFTRSIsImRwYUxvY2FsZSI6ImVzX0NMIiwiZHBhQWNjZXB0ZWRTaGlwcGluZ0NvdW50cmllcyI6WyJVUyIsIkdCIl0sImNvbnN1bWVyRW1haWxBZGRyZXNzUmVxdWVzdGVkIjpmYWxzZSwiY29uc3VtZXJQaG9uZU51bWJlclJlcXVlc3RlZCI6ZmFsc2UsInRyYW5zYWN0aW9uQW1vdW50Ijp7InRyYW5zYWN0aW9uQW1vdW50IjoiMjAwMDAiLCJ0cmFuc2FjdGlvbkN1cnJlbmN5Q29kZSI6IkNPUCJ9LCJkcGFBY2NlcHRlZEJpbGxpbmdDb3VudHJpZXMiOltdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IlBPU1RBTF9DT1VOVFJZIiwiZHBhU2hpcHBpbmdQcmVmZXJlbmNlIjoiTk9ORSIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwicGF5bG9hZFR5cGVJbmRpY2F0b3IiOiJGVUxMIiwicGF5bWVudE9wdGlvbnMiOnsiZHluYW1pY0RhdGFUeXBlIjoiQ0FSRF9BUFBMSUNBVElPTl9DUllQVE9HUkFNX1NIT1JUX0ZPUk0ifX19fSwiU1JDQU1FWCI6eyJvcmlnaW4iOiJodHRwczovL3F3d3cuYWV4cC1zdGF0aWMuY29tIiwicGF0aCI6Ii9ha2FtYWkvcmVtb3RlY29tbWVyY2Uvc2NyaXB0cy9hbWV4U0RLLTEuMC4wLmpzIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6InNyYy1hbWV4LWNhcmQtZW5jLTIwMjUiLCJhbGciOiJSU0EtT0FFUC0yNTYiLCJuIjoidk1LQjM2SXVrem93akJJVXYtMUNSTE5yMk9ydmhfU0JtT1hXazBRVUl1bTJiY3pwQUVsUEVXdnR2MlE3bjlLMWFOOHZ6WWgzTVl5R25INjhhdjRDUnhvTng4UFlWSU9lZk4zSHJVTU1SQ3M3NFBzY2RwTTRNTlVocGZIX1NWYWx2M0tZRlJEYVp4Zm9jZTFERFFVVGRyNHJYUnI5b1c0aVFJVmRfZkpOQmlMSVU3Zm1TSERkazdsVnFRZ2hhUExKWFRDNnh6UXpramEzQVB2bmZrZVhGVXZpVVg2dndxbjJiTENqV2dIVmNkMW5yS01OalMxTjJpd2swUXdaZW5kbHlyVEhwZTU1d2FIOGx4Z2xpUEVOVzVIemdkNTBRR3pFTWlqcUJ3TVVGd0VqVWJ1bWtmd1I0dlBrLUc1QXZTc0JUbklFYldYTzVaa2p5aW1BZi0zT0tiNGhiREVRLXh6czhsakFQTVFPSnkwQjl1cl84RV9UOFdEdEc4OHFxVmRjbHBGVm1IRHJxYmpzY1RQY2k0ZGRBZHFWLXBwd0JzNzA0MmNsM2l0RVpvTnBKOXlxTzVPS3NjbWNLalMxSkhsbGVpWUMyNDh3NXEzUFhYcl9QM1NPaml0V2xpLW9PbE90Q1lIXzJxMEVzNlJud2R6Q0hPVThYWk93a0l2Y2hRQUQifSwicGFyYW1ldGVycyI6eyJzcmNpVHJhbnNhY3Rpb25JZCI6IjdkODgzNTg1LTY3MjctNDlmZi05NjFjLWZlZDJhYTlhNTMzNCIsInNyY0luaXRpYXRvcklkIjoiOGVjMmM4ODgtNjRjYy00ZWZjLTkxNzUtYjMzNzQ1MmIyOGM4IiwiZHBhRGF0YSI6eyJkcGFOYW1lIjoiR0VUTkVUIENISUxFIFMuQS4iLCJkcGFMb2dvVXJpIjoiaHR0cHM6Ly93d3cuZ2V0bmV0LmNsLyIsImRwYVByZXNlbnRhdGlvbk5hbWUiOiJHRVRORVQgQ0hJTEUgUy5BLiIsImRwYVVyaSI6Imh0dHBzOi8vd3d3LmdldG5ldC5jbC8ifSwiZHBhVHJhbnNhY3Rpb25PcHRpb25zIjp7ImRwYUxvY2FsZSI6ImVzX0NMIiwiZHBhQWNjZXB0ZWRCaWxsaW5nQ291bnRyaWVzIjpbXSwiZHBhQWNjZXB0ZWRTaGlwcGluZ0NvdW50cmllcyI6WyJVUyIsIkdCIl0sImRwYUJpbGxpbmdQcmVmZXJlbmNlIjoiUE9TVEFMX0NPVU5UUlkiLCJkcGFTaGlwcGluZ1ByZWZlcmVuY2UiOiJOT05FIiwiY29uc3VtZXJOYW1lUmVxdWVzdGVkIjp0cnVlLCJjb25zdW1lckVtYWlsQWRkcmVzc1JlcXVlc3RlZCI6ZmFsc2UsImNvbnN1bWVyUGhvbmVOdW1iZXJSZXF1ZXN0ZWQiOmZhbHNlLCJyZXZpZXdBY3Rpb24iOiJjb250aW51ZSIsInRocmVlRHNQcmVmZXJlbmNlIjoiTk9ORSJ9fX19LCJjYXB0dXJlTWFuZGF0ZSI6eyJiaWxsaW5nVHlwZSI6IlBBUlRJQUwiLCJyZXF1ZXN0RW1haWwiOmZhbHNlLCJyZXF1ZXN0UGhvbmUiOmZhbHNlLCJyZXF1ZXN0U2hpcHBpbmciOmZhbHNlLCJzaGlwVG9Db3VudHJpZXMiOlsiVVMiLCJHQiJdLCJzaG93QWNjZXB0ZWROZXR3b3JrSWNvbnMiOmZhbHNlfSwib3JkZXJJbmZvcm1hdGlvbiI6eyJhbW91bnREZXRhaWxzIjp7InRvdGFsQW1vdW50IjoiMjAwMDAiLCJjdXJyZW5jeSI6IkNPUCJ9LCJiaWxsVG8iOnsiYWRkcmVzczEiOiI5MDAgTWV0cm8gQ2VudGVyIEJsdmQiLCJhZG1pbmlzdHJhdGl2ZUFyZWEiOiJDQSIsImJ1aWxkaW5nTnVtYmVyIjoiMSIsImNvdW50cnkiOiJVUyIsImRpc3RyaWN0IjoiZGlzdHJpY3QiLCJsb2NhbGl0eSI6IkZvc3RlciBDaXR5IiwicG9zdGFsQ29kZSI6Ijk0NDA0IiwiZW1haWwiOiJqdWFucGFwYWJvbkBnbWFpbC5jb20iLCJmaXJzdE5hbWUiOiJNYXlhIiwibGFzdE5hbWUiOiJUcmFuIiwibWlkZGxlTmFtZSI6IlMiLCJ0aXRsZSI6Ik1zIiwicGhvbmVOdW1iZXIiOiIzMDA2NzE5MjM1IiwicGhvbmVUeXBlIjoicGhvbmVUeXBlIn19LCJ0YXJnZXRPcmlnaW5zIjpbImh0dHBzOi8vcG9jLWxlbW9uLWZpdmUudmVyY2VsLmFwcCJdLCJpZnJhbWVzIjp7Im1jZSI6Ii9tY2UvbWNlLmh0bWwiLCJidXR0b25zIjoiL2J1dHRvbmxpc3QvYnV0dG9ubGlzdC5odG1sIiwic3JjIjoiL3NlY3VyZS1yZW1vdGUtY29tbWVyY2Uvc3JjLmh0bWwiLCJjdHAiOiIvY3RwL2N0cC5odG1sIiwiZ29vZ2xlcGF5IjoiL2dvb2dsZXBheS9nb29nbGVwYXkuaHRtbCIsImFwcGxlcGF5IjoiL2FwcGxlcGF5L2FwcGxlcGF5Lmh0bWwiLCJwYXplIjoiL3BhemUvcGF6ZS5odG1sIiwiY2hlY2siOiIvY2hlY2svY2hlY2suaHRtbCJ9LCJjbGllbnRWZXJzaW9uIjoiMC4yMiIsImNvdW50cnkiOiJDTCIsImxvY2FsZSI6ImVzX0NMIiwiYWxsb3dlZENhcmROZXR3b3JrcyI6WyJWSVNBIiwiTUFTVEVSQ0FSRCIsIkFNRVgiXSwiY3IiOiJJaUZ6b0lkMkVZTTNPOFZnaG91dmszTlFiclhCUVJoMUJVampGZTFUQXdNSUFyTGdtSjF3a3ZXTjFwTF9NSTJKeWg2SjIyazF0WDhLaTZJWG9YeXhYQ3ZyMWpuQkFnUDZuSUZVVXlDb3FQd2ZtU1FsVDcxWThMbHMiLCJzZXJ2aWNlT3JpZ2luIjoiaHR0cHM6Ly9hcGl0ZXN0LmN5YmVyc291cmNlLmNvbSIsImNsaWVudExpYnJhcnkiOiJodHRwczovL2FwaXRlc3QuY3liZXJzb3VyY2UuY29tL3VjL3YxL2Fzc2V0cy8wLjIyLjQvU2VjdXJlQWNjZXB0YW5jZS5qcyIsImxvZ2dpbmdQYXRoIjoiL3VjL3YxL2xvZy1ldmVudHMiLCJhc3NldHNQYXRoIjoiL3VjL3YxL2Fzc2V0cy8wLjIyLjQiLCJjbGllbnRMaWJyYXJ5SW50ZWdyaXR5Ijoic2hhMjU2LXQza1dxcnFLcFdBYkg1Q0NUOGQ3L3hMbWR4TDhobXNKUXdHRUt1azFyRG9cdTAwM2QifSwidHlwZSI6ImdkYS0wLjkuMCJ9XSwiaXNzIjoiRmxleCBBUEkiLCJleHAiOjE3Mzc1NjM1MDIsImlhdCI6MTczNzU2MjYwMiwianRpIjoiY2ZXSjJRR0psWWNLWkE3WiJ9.R1yYkxlD8nwFQo-152Ud_h4m7edw41tY0YTeGB5uOgtNnuGtryI8kh1NtM-3YLu1y1wI9arxlV5TIcXtB-ep-ZH1zbvopXnG2TOc6zRnMliEbQcZW1_VfypdswaCG_HsdvDcbDIqZz8BrlERCdgnS3sTCR9wSq3DkWpxIosr8grQgl5HZgTuqkhuuyRORu-DkMNWW3fb7LHNsjofaXIdGqXjrYGOc2Vz0TQb85B1goCiSm_RWJBASpqRkxn1OGaR1-E_SjMqyvzAgzKvl7QZ8ugoYLIwm4EjFX2pX6x-v4b0gBt-4R7J87a-yDa5c7yw5Z15lMGPW03Xz8N6T6x3_g';
  const showArgs = {
    containers: {
      paymentSelection: "#buttonPaymentListContainer"
    }
  };

  Accept(captureContext)
      .then(accept => accept.unifiedPayments())
      .then(up => up.show(showArgs))
      .then(tt => {
        const transientToken = document.getElementById('transientToken');
        transientToken.value = tt;

        console.log('tt:', tt);
      })
      .catch(error => {
        console.error("Error en el flujo de Click to Pay:", error);
      });

  console.log('cargado script de VISA Click to Pay');
};

onMounted(() => {
  console.log('Actualizado el 22 de enero a las 11:26 am')
  loadVisaClickToPay();
});
</script>