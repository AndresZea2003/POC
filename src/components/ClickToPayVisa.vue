<template>
  <div>
    <div id="buttonPaymentListContainer"></div>
    <textarea id="transientToken" name="transientToken" rows="25" cols="50"></textarea>
  </div>
</template>

<script setup>
import { onMounted } from 'vue';

const loadVisaClickToPay = async () => {
  console.log('Cargando script de VISA Click to Pay...');
  const script = document.createElement('script');
  script.src = 'https://apitest.cybersource.com/up/v1/assets/0.22.0/SecureAcceptance.js'; // clientLibrary obtenido de la captura de contexto
  script.async = true;
  script.onload = await onVisaClickToPayLoaded;
  script.onerror = function() {
    console.error('Error al cargar el script de VISA Click to Pay.');
  };
  document.head.appendChild(script);
};

const onVisaClickToPayLoaded = async () => {
  const captureContext = 'eyJraWQiOiJ6dSIsImFsZyI6IlJTMjU2In0.eyJmbHgiOnsicGF0aCI6Ii9mbGV4L3YyL3Rva2VucyIsImRhdGEiOiI2KzV5Z0cyT3pTcVhaMTB2WDVydkJCQUFFTVhGWUFqZlMxOCtaTFBnaGtsZFVzT0x1dGVZSTFNSmtwNjJheHZkTyt2dEhlU1ZVS1hvUzNPWkFoY2srUEY1SWR1bDZCKzVGMmpDLzRDRVdQSHhUTkx6d3krWStLL1lNcllrRFZsQ1Z1aUNwWGo0VHdoRWZFdGhRaFU4NXh5eG9BXHUwMDNkXHUwMDNkIiwib3JpZ2luIjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20iLCJ0cmFuc2llbnRUb2tlbk9wZXJhdGlvbnMiOlt7InN1YiI6InRlc3RnZXRuZXRjbF9zYW5kYm94MDAxIiwiYXVkIjoiZ2V0bmV0Y2xfc2FuZGJveCIsImtpZCI6ImUwNDQ5YWU4LTUxZDgtNDQ0MC1iN2IzLWJiODQxYWYzNjIwMiIsInR5cGUiOiJTVE9SRSJ9XSwiandrIjp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwibiI6InI1amxOXzlfOFNobk1ydndUNV9nQUc3RmdMYUNuNnRENGtRLW9hN2lDdWQzUDFaMlk2UFowRjVTeWdpUnBOVUZSV3VBT2pSeVNrckFwZnRpcEZGRzM1V1BmekF5UVZna2paYUVCaXQ2YS1faEZaTl9BVDd6cnNVY01wQjZGakR2V2ticHlMUEp1Q2NjcTJZMTg3Ql9GT3ZCbExSc1lOX0duSHB0RGtvcnBKdUJnRVNpUi1taHdOMENLTnctcUZkLUE3YXUtQ0FlcFVTWU9WV0lHR1NtcTJEZWtXaWtoNVFQZ2wta2w4YTN3X3ZfeDFVcW5FSmNGSERVV29YUXhydkZWd0Q3LTI2cWZCZmlTaTdTSjdsQlZEOVNXNElDa2VNUVBNb0w0eDVNNnNsSXkwNVEtS0FETnQ3czRKN3h5M1lrZjNGU3VlNUJsd0JVSHZESWtSLTJkUSIsImtpZCI6IjA4NjdWeHRSd1ZhMUlxMkpFSk1SaHNUOHZEVWp6S01kIn19LCJjdHgiOlt7ImRhdGEiOnsiYWxsb3dlZFBheW1lbnRUeXBlcyI6W3sicGFnZSI6MSwidHlwZSI6IkNMSUNLVE9QQVkifSx7InBhZ2UiOjIsInR5cGUiOiJTUkNWSVNBIn0seyJwYWdlIjozLCJ0eXBlIjoiU1JDTUFTVEVSQ0FSRCJ9LHsicGFnZSI6NCwidHlwZSI6IlNSQ0FNRVgifSx7InBhZ2UiOjUsInR5cGUiOiJQQU5FTlRSWSJ9XSwicGF5bWVudENvbmZpZ3VyYXRpb25zIjp7IlNSQ1ZJU0EiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LWFzc2V0cy5zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20iLCJwYXRoIjoiL2NoZWNrb3V0LXdpZGdldC9yZXNvdXJjZXMvanMvc3JjLWktYWRhcHRlci92aXNhU2RrLmpzP3YyIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjNHUFdQVkkzRVNXM0dDSlMyWTVGMTNhZVVZbEtUVlRoWGlTMlRLbllLRXRMbC1RRU0iLCJuIjoic1pQSXVzRGY3eVFubmhCa1U5bXUxNFZPTzNDcnVpM2I3ckFmMktZZW9iVVJtWEExN2IxSlg5amcwQ2QtdmdwbXV5VHJ4QlVTYy00YjAtVVBnU3dHRnFQV1VweDA4RXhxcndQRE92Rm9qQm91MndseXE4YmN5MFVzLUJmZUN6U0U1bE1WZFNYVFhYWGNOcXUtcWIyMmpDQ0NKQUxweHNBcnNib01PWHNMZWRoM000WE5RNVhHQXRSZjdiLS11VFk1RHI5S0xZeVV2WktBblkwNE1LSlBFTzU0WWlJRk01RFRBaE5PbXMwODlqZE1keC1VUklLSmpQVTItUnBIRzF1OExDRzAyOFJUSXBQc05iUmFudVM1VEFZX3pseERnYjFoS0ozNlliWkVOSExnOVBYVEJoZE9NbFU5MERUTGxmY2JMVGEtRDdEZ2xqQWFXQ3V2ekxQYUd3In0sInBhcmFtZXRlcnMiOnsic3JjSW5pdGlhdG9ySWQiOiJKRkNaOFFWT0pBNzZOWFo2OEZaRDIxUllJeGozeVBaZGlVeGtkTnVpYkJseGd3YVA0Iiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjaVRyYW5zYWN0aW9uSWQiOiJmM2I2OGIzMS1hMzJiLTRhZWMtYWI2YS0wMmNhZjI2OGRhZWQiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsiZHBhTG9jYWxlIjoiZW5fVVMiLCJwYXlsb2FkVHlwZUluZGljYXRvciI6IkZVTEwiLCJyZXZpZXdBY3Rpb24iOiJjb250aW51ZSIsImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJDTyJdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IkFMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6Ik5PTkUiLCJjb25zdW1lck5hbWVSZXF1ZXN0ZWQiOnRydWUsImNvbnN1bWVyRW1haWxBZGRyZXNzUmVxdWVzdGVkIjpmYWxzZSwiY29uc3VtZXJQaG9uZU51bWJlclJlcXVlc3RlZCI6ZmFsc2UsIm1lcmNoYW50Q291bnRyeUNvZGUiOiJVUyIsImN1c3RvbUlucHV0RGF0YSI6eyJjaGVja291dE9yY2hlc3RyYXRvciI6Im1lcmNoYW50In0sInRyYW5zYWN0aW9uQW1vdW50Ijp7InRyYW5zYWN0aW9uQW1vdW50IjoiMjEuMDAiLCJ0cmFuc2FjdGlvbkN1cnJlbmN5Q29kZSI6IlVTRCJ9LCJwYXltZW50T3B0aW9ucyI6eyJkcGFEeW5hbWljRGF0YVR0bE1pbnV0ZXMiOjE1LCJkcGFQYW5SZXF1ZXN0ZWQiOmZhbHNlLCJkeW5hbWljRGF0YVR5cGUiOiJDQVJEX0FQUExJQ0FUSU9OX0NSWVBUT0dSQU1fTE9OR19GT1JNIn19fX0sIlNSQ01BU1RFUkNBUkQiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LnNyYy5tYXN0ZXJjYXJkLmNvbSIsInBhdGgiOiIvc2RrL3NyY3Nkay5tYXN0ZXJjYXJkLmpzIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjIwMjMwMjA3MjIzNTIxLXNhbmRib3gtZnBhbi1lbmNyeXB0aW9uLXNyYy1tYXN0ZXJjYXJkLWludCIsImtleV9vcHMiOlsiZW5jcnlwdCIsIndyYXBLZXkiXSwiYWxnIjoiUlNBLU9BRVAtMjU2IiwibiI6InQwNkk4c2psUy1ycnM3dUNhZ0g4ZXZvZXVtYVJvdkt6aVpTSTlTMk45SURROXRXMlBhcGZSYTlMYzFLdmVFQkRWczI3UGtoa1U1T3lIZ1AwaUVqVHVLVnB2aDU5VDRsYS1tQlNJbHM3VWVjVVFMTGEwV2ttYnRMN2pOZGx0QTVmcTdBaGNBcjVxY2E5ODhxckxkN0l5cjlFMEMzVHhiVDl0bzFpUWNwejhvY1pPRFJYb2lkRkFuT1ZMNVlHRm1sc3JlRGJKNFZoc2kwcEFkY2NRY2lsLXlkU2d1cktCLXJxS3BwYjllcG9tdTRRVWgzMzgyQ3Y4Tm9iWW1GM29zOG5HR2dHUC1jeVhvMG5zS2NQQWdmcmxRem9zN3FIeFVPckZlMnhfbFoxRzFBRS1YcmtyeGpCeXM5cTUzR01SU05DUThjLV9tY0Y5cGJxNEhZQnMtdkQ1USJ9LCJwYXJhbWV0ZXJzIjp7InNyY2lUcmFuc2FjdGlvbklkIjoiZjNiNjhiMzEtYTMyYi00YWVjLWFiNmEtMDJjYWYyNjhkYWVkIiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjSW5pdGlhdG9ySWQiOiI4NDRmN2UzZC0wN2YwLTQ0YjEtYTIzNy1lNjQyNDQ0ZTA1MTIiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsidHJhbnNhY3Rpb25UeXBlIjoiUFVSQ0hBU0UiLCJkcGFMb2NhbGUiOiJlbl9VUyIsImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJDTyJdLCJjb25zdW1lckVtYWlsQWRkcmVzc1JlcXVlc3RlZCI6ZmFsc2UsImNvbnN1bWVyUGhvbmVOdW1iZXJSZXF1ZXN0ZWQiOmZhbHNlLCJ0cmFuc2FjdGlvbkFtb3VudCI6eyJ0cmFuc2FjdGlvbkFtb3VudCI6IjIxLjAwIiwidHJhbnNhY3Rpb25DdXJyZW5jeUNvZGUiOiJVU0QifSwiZHBhQWNjZXB0ZWRCaWxsaW5nQ291bnRyaWVzIjpbXSwiZHBhQmlsbGluZ1ByZWZlcmVuY2UiOiJGVUxMIiwiZHBhU2hpcHBpbmdQcmVmZXJlbmNlIjoiTk9ORSIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwicGF5bG9hZFR5cGVJbmRpY2F0b3IiOiJGVUxMIiwicGF5bWVudE9wdGlvbnMiOnsiZHluYW1pY0RhdGFUeXBlIjoiQ0FSRF9BUFBMSUNBVElPTl9DUllQVE9HUkFNX1NIT1JUX0ZPUk0ifX19fSwiU1JDQU1FWCI6eyJvcmlnaW4iOiJodHRwczovL3F3d3cuYWV4cC1zdGF0aWMuY29tIiwicGF0aCI6Ii9ha2FtYWkvcmVtb3RlY29tbWVyY2Uvc2NyaXB0cy9hbWV4U0RLLTEuMC4wLmpzIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6InNyYy1hbWV4LWNhcmQtZW5jLTIwMjUiLCJhbGciOiJSU0EtT0FFUC0yNTYiLCJuIjoidk1LQjM2SXVrem93akJJVXYtMUNSTE5yMk9ydmhfU0JtT1hXazBRVUl1bTJiY3pwQUVsUEVXdnR2MlE3bjlLMWFOOHZ6WWgzTVl5R25INjhhdjRDUnhvTng4UFlWSU9lZk4zSHJVTU1SQ3M3NFBzY2RwTTRNTlVocGZIX1NWYWx2M0tZRlJEYVp4Zm9jZTFERFFVVGRyNHJYUnI5b1c0aVFJVmRfZkpOQmlMSVU3Zm1TSERkazdsVnFRZ2hhUExKWFRDNnh6UXpramEzQVB2bmZrZVhGVXZpVVg2dndxbjJiTENqV2dIVmNkMW5yS01OalMxTjJpd2swUXdaZW5kbHlyVEhwZTU1d2FIOGx4Z2xpUEVOVzVIemdkNTBRR3pFTWlqcUJ3TVVGd0VqVWJ1bWtmd1I0dlBrLUc1QXZTc0JUbklFYldYTzVaa2p5aW1BZi0zT0tiNGhiREVRLXh6czhsakFQTVFPSnkwQjl1cl84RV9UOFdEdEc4OHFxVmRjbHBGVm1IRHJxYmpzY1RQY2k0ZGRBZHFWLXBwd0JzNzA0MmNsM2l0RVpvTnBKOXlxTzVPS3NjbWNLalMxSkhsbGVpWUMyNDh3NXEzUFhYcl9QM1NPaml0V2xpLW9PbE90Q1lIXzJxMEVzNlJud2R6Q0hPVThYWk93a0l2Y2hRQUQifSwicGFyYW1ldGVycyI6eyJzcmNpVHJhbnNhY3Rpb25JZCI6ImYzYjY4YjMxLWEzMmItNGFlYy1hYjZhLTAyY2FmMjY4ZGFlZCIsInNyY0luaXRpYXRvcklkIjoiOGVjMmM4ODgtNjRjYy00ZWZjLTkxNzUtYjMzNzQ1MmIyOGM4IiwiZHBhRGF0YSI6eyJkcGFOYW1lIjoiR0VUTkVUIENISUxFIFMuQS4iLCJkcGFMb2dvVXJpIjoiaHR0cHM6Ly93d3cuZ2V0bmV0LmNsLyIsImRwYVByZXNlbnRhdGlvbk5hbWUiOiJHRVRORVQgQ0hJTEUgUy5BLiIsImRwYVVyaSI6Imh0dHBzOi8vd3d3LmdldG5ldC5jbC8ifSwiZHBhVHJhbnNhY3Rpb25PcHRpb25zIjp7ImRwYUxvY2FsZSI6ImVuX1VTIiwiZHBhQWNjZXB0ZWRCaWxsaW5nQ291bnRyaWVzIjpbXSwiZHBhQWNjZXB0ZWRTaGlwcGluZ0NvdW50cmllcyI6WyJVUyIsIkNPIl0sImRwYUJpbGxpbmdQcmVmZXJlbmNlIjoiQUxMIiwiZHBhU2hpcHBpbmdQcmVmZXJlbmNlIjoiTk9ORSIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwiY29uc3VtZXJFbWFpbEFkZHJlc3NSZXF1ZXN0ZWQiOmZhbHNlLCJjb25zdW1lclBob25lTnVtYmVyUmVxdWVzdGVkIjpmYWxzZSwicmV2aWV3QWN0aW9uIjoiY29udGludWUiLCJ0aHJlZURzUHJlZmVyZW5jZSI6Ik5PTkUifX19fSwiY2FwdHVyZU1hbmRhdGUiOnsiYmlsbGluZ1R5cGUiOiJGVUxMIiwicmVxdWVzdEVtYWlsIjpmYWxzZSwicmVxdWVzdFBob25lIjpmYWxzZSwicmVxdWVzdFNoaXBwaW5nIjpmYWxzZSwic2hpcFRvQ291bnRyaWVzIjpbIlVTIiwiQ08iXSwic2hvd0FjY2VwdGVkTmV0d29ya0ljb25zIjp0cnVlfSwib3JkZXJJbmZvcm1hdGlvbiI6eyJhbW91bnREZXRhaWxzIjp7InRvdGFsQW1vdW50IjoiMjEuMDAiLCJjdXJyZW5jeSI6IlVTRCJ9LCJiaWxsVG8iOnsiYWRkcmVzczEiOiIxMTExIFBhcmsgU3RyZWV0IiwiYWRkcmVzczIiOiJBcGFydG1lbnQgMjRCIiwiYWRtaW5pc3RyYXRpdmVBcmVhIjoiTlkiLCJidWlsZGluZ051bWJlciI6IjEiLCJjb3VudHJ5IjoiVVMiLCJkaXN0cmljdCI6ImRpc3RyaWN0IiwibG9jYWxpdHkiOiJOZXcgWW9yayIsInBvc3RhbENvZGUiOiIwMDAwMCIsImNvbXBhbnkiOnsiYWRkcmVzczEiOiI5MDAgTWV0cm8gQ2VudGVyIEJsdmQiLCJhZG1pbmlzdHJhdGl2ZUFyZWEiOiJDQSIsImJ1aWxkaW5nTnVtYmVyIjoiMSIsImNvdW50cnkiOiJVUyIsImRpc3RyaWN0IjoiZGlzdHJpY3QiLCJsb2NhbGl0eSI6IkZvc3RlciBDaXR5IiwicG9zdGFsQ29kZSI6Ijk0NDA0IiwibmFtZSI6IlZpc2EgSW5jIn0sImVtYWlsIjoibWF5YS50cmFuQGNvbXBhbnkuY29tIiwiZmlyc3ROYW1lIjoiTWF5YSIsImxhc3ROYW1lIjoiVHJhbiIsIm1pZGRsZU5hbWUiOiJTIiwidGl0bGUiOiJNcyIsInBob25lTnVtYmVyIjoiMTIzNDU2Nzg5MCIsInBob25lVHlwZSI6InBob25lVHlwZSJ9LCJzaGlwVG8iOnsiYWRkcmVzczEiOiJWaXNhIiwiYWRkcmVzczIiOiIxMjMgTWFpbiBTdHJlZXQiLCJhZGRyZXNzMyI6IkFwYXJ0bWVudCAxMDIiLCJhZG1pbmlzdHJhdGl2ZUFyZWEiOiJDQSIsImJ1aWxkaW5nTnVtYmVyIjoic3RyaW5nIiwiY291bnRyeSI6IlVTIiwiZGlzdHJpY3QiOiJkaXN0cmljdCIsImxvY2FsaXR5IjoiRm9zdGVyIENpdHkiLCJwb3N0YWxDb2RlIjoiOTQ0MDQiLCJmaXJzdE5hbWUiOiJKb2UiLCJsYXN0TmFtZSI6IlNvYXAifX0sInRhcmdldE9yaWdpbnMiOlsiaHR0cHM6Ly9wb2MtbGVtb24tZml2ZS52ZXJjZWwuYXBwIl0sImlmcmFtZXMiOnsibWNlIjoiL21jZS9tY2UuaHRtbCIsImJ1dHRvbnMiOiIvYnV0dG9ubGlzdC9idXR0b25saXN0Lmh0bWwiLCJzcmMiOiIvc2VjdXJlLXJlbW90ZS1jb21tZXJjZS9zcmMuaHRtbCIsImN0cCI6Ii9jdHAvY3RwLmh0bWwiLCJnb29nbGVwYXkiOiIvZ29vZ2xlcGF5L2dvb2dsZXBheS5odG1sIiwiYXBwbGVwYXkiOiIvYXBwbGVwYXkvYXBwbGVwYXkuaHRtbCIsInBhemUiOiIvcGF6ZS9wYXplLmh0bWwiLCJjaGVjayI6Ii9jaGVjay9jaGVjay5odG1sIn0sImNsaWVudFZlcnNpb24iOiIwLjE5IiwiY291bnRyeSI6IlVTIiwibG9jYWxlIjoiZW5fVVMiLCJhbGxvd2VkQ2FyZE5ldHdvcmtzIjpbIlZJU0EiLCJNQVNURVJDQVJEIiwiQU1FWCJdLCJjciI6IkRlNEZfZi0tczBPRjI5M3VLSUtaMWdLb3FIUmdGX0FBVm1SVHNKVGhpNVFmOE9YNWJDelJYdGhtbmtENjVMNlAzNHRpMW9OcjhzME5ZNXVydll2d0duZUdka1hDNWF5TVZQY2V1U1VwaERTam56bmk1NTlMQ2l3diIsInNlcnZpY2VPcmlnaW4iOiJodHRwczovL2FwaXRlc3QuY3liZXJzb3VyY2UuY29tIiwiY2xpZW50TGlicmFyeSI6Imh0dHBzOi8vYXBpdGVzdC5jeWJlcnNvdXJjZS5jb20vdWMvdjEvYXNzZXRzLzAuMTkuNC9TZWN1cmVBY2NlcHRhbmNlLmpzIiwibG9nZ2luZ1BhdGgiOiIvdWMvdjEvbG9nLWV2ZW50cyIsImFzc2V0c1BhdGgiOiIvdWMvdjEvYXNzZXRzLzAuMTkuNCIsImNsaWVudExpYnJhcnlJbnRlZ3JpdHkiOiJzaGEyNTYtZlpjenRib3QrTDlXZjRsRDFlNDNEMmRObjA3SnM2SW1LOTJWNTVpZUF5RVx1MDAzZCJ9LCJ0eXBlIjoiZ2RhLTAuOS4wIn1dLCJpc3MiOiJGbGV4IEFQSSIsImV4cCI6MTczNDk4Nzk1NiwiaWF0IjoxNzM0OTg3MDU2LCJqdGkiOiJxdVZqd1VaeEphQm9NNXNBIn0.RvZCyH2aC4e8UgVAu1t14BrygVBj2dn1FaZKw-bLuiKYa3AvN8UjObM6MYffJQJIBehlgnVSP03fORzlADbN0WQWfIDqzJtBUisriZnhfYE4Pw4YJ3eXBh-6iwFvV1gzwW_NmacaymZXLMyZQAT9I9V4CSyJ-rZaroyd_QQA3AxOqE1jQ7VsYZu_iEe4qxWtLE7NP04luKEW5KjMaaJbpQWSzg8WzbO35oT_UK8lM_4lk4zY--Dul0a7AgP70FZDEiQJfdWW_m39e6yLva_xF47iyws2LBatZBgGGnzQjXe1uMk2vWs1KDtLTGsb4CSwExm5VVggc92gAlW7Uwi4nA';
  const showArgs = {
    containers: {
      paymentSelection: "#buttonPaymentListContainer"
    }
  };

  Accept(captureContext)
      .then(accept => accept.unifiedPayments())
      .then(up => up.show(showArgs))
      .then(tt => {
        const transientToken = document.getElementById('transientToken');
        transientToken.value = tt;

        console.log('tt:', tt);
      })
      .catch(error => {
        console.error("Error en el flujo de Click to Pay:", error);
      });

  console.log('cargado script de VISA Click to Pay');
};

onMounted(() => {
  console.log('Actualizado el 23 de dic a las 03:52 pm')
  loadVisaClickToPay();
});
</script>
