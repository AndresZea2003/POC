<template>
  <div>
    <div id="buttonPaymentListContainer"></div>
    <textarea id="transientToken" name="transientToken" rows="25" cols="50"></textarea>
  </div>
</template>

<script setup>
import { onMounted } from 'vue';

const loadVisaClickToPay = async () => {
  console.log('Cargando script de VISA Click to Pay...');
  const script = document.createElement('script');
  script.src = 'https://apitest.cybersource.com/up/v1/assets/0.22.0/SecureAcceptance.js'; // clientLibrary obtenido de la captura de contexto
  script.async = true;
  script.onload = await onVisaClickToPayLoaded;
  script.onerror = function() {
    console.error('Error al cargar el script de VISA Click to Pay.');
  };
  document.head.appendChild(script);
};

const onVisaClickToPayLoaded = async () => {
  const captureContext = 'eyJraWQiOiJ6dSIsImFsZyI6IlJTMjU2In0.eyJmbHgiOnsicGF0aCI6Ii9mbGV4L3YyL3Rva2VucyIsImRhdGEiOiJTOWM2ZjlMTDFUYjR2MFJvSlFjd2F4QUFFSU1OeTVsNnJNV0Y5MzNFSzVrcUJCZ2ZBVnpyVVpUZjQzSEcvdS9SZWNjOFowVUNKU0kxdDJndFRsZHlJbEhQOWQ0V0ZtRzFwVWc2QzZkTEVYaThia0tXNmJWR09velpqOFowWFhLbjE5dEVxVm1KNUIyUUlDU3gvRTVXMW5kUUFRXHUwMDNkXHUwMDNkIiwib3JpZ2luIjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20iLCJ0cmFuc2llbnRUb2tlbk9wZXJhdGlvbnMiOlt7InN1YiI6InRlc3RnZXRuZXRjbF9zYW5kYm94MDAxIiwiYXVkIjoiZ2V0bmV0Y2xfc2FuZGJveCIsImtpZCI6ImUwNDQ5YWU4LTUxZDgtNDQ0MC1iN2IzLWJiODQxYWYzNjIwMiIsInR5cGUiOiJTVE9SRSJ9XSwiandrIjp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwibiI6InhtZldTbzQ1Tl82N3FfX1VSNy0ySVlxa05HZUZlM3JhQ0dFWUlybXh1N0dNU01XSG5LMDhKekVrWUJoOGtNMzBDLXY2STlZUnlYemRMMDVITTJPbVZzVkdZUnhsaUswZHM3bnY3T1k3Rk1QcFAyVFdEZXYzZ29CbU9FRnY3NWdTazBjZDI2U3czeklJQzZ6QzBqTTF1dmhtUzJpLVZDX0hPa0hpR0RmS0xfQVQxTXM3QUNtWkxxNlFlNEt0Z2RQZlg3V3ZDWjFwTkV0YXhqTmlpbkpWdHhuSG8zendPbG5QUC13a0d3c0RUVDFiVXZPUUhoLTVtYTB2Y1A3cENNLXYtUWFzOTc4SzVCUmVTOEFWb280MFpJcVFOdG9kQ1hxYVJaRm5YSXp3cDFYZjJjS3hzWngxeGVLOTFBa1dtUFlxZHctbFFBSG1fekY1NmItYXVNR2VEdyIsImtpZCI6IjA4UG5SMzR2MXd0MlliY1VUU0QzTHRjWGJXSHlJSkttIn19LCJjdHgiOlt7ImRhdGEiOnsiYWxsb3dlZFBheW1lbnRUeXBlcyI6W3sicGFnZSI6MSwidHlwZSI6IkNMSUNLVE9QQVkifSx7InBhZ2UiOjIsInR5cGUiOiJTUkNWSVNBIn0seyJwYWdlIjozLCJ0eXBlIjoiU1JDTUFTVEVSQ0FSRCJ9LHsicGFnZSI6NCwidHlwZSI6IlNSQ0FNRVgifSx7InBhZ2UiOjUsInR5cGUiOiJQQU5FTlRSWSJ9XSwicGF5bWVudENvbmZpZ3VyYXRpb25zIjp7IlNSQ1ZJU0EiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LWFzc2V0cy5zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20iLCJwYXRoIjoiL2NoZWNrb3V0LXdpZGdldC9yZXNvdXJjZXMvanMvc3JjLWktYWRhcHRlci92aXNhU2RrLmpzP3YyIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjNHUFdQVkkzRVNXM0dDSlMyWTVGMTNhZVVZbEtUVlRoWGlTMlRLbllLRXRMbC1RRU0iLCJuIjoic1pQSXVzRGY3eVFubmhCa1U5bXUxNFZPTzNDcnVpM2I3ckFmMktZZW9iVVJtWEExN2IxSlg5amcwQ2QtdmdwbXV5VHJ4QlVTYy00YjAtVVBnU3dHRnFQV1VweDA4RXhxcndQRE92Rm9qQm91MndseXE4YmN5MFVzLUJmZUN6U0U1bE1WZFNYVFhYWGNOcXUtcWIyMmpDQ0NKQUxweHNBcnNib01PWHNMZWRoM000WE5RNVhHQXRSZjdiLS11VFk1RHI5S0xZeVV2WktBblkwNE1LSlBFTzU0WWlJRk01RFRBaE5PbXMwODlqZE1keC1VUklLSmpQVTItUnBIRzF1OExDRzAyOFJUSXBQc05iUmFudVM1VEFZX3pseERnYjFoS0ozNlliWkVOSExnOVBYVEJoZE9NbFU5MERUTGxmY2JMVGEtRDdEZ2xqQWFXQ3V2ekxQYUd3In0sInBhcmFtZXRlcnMiOnsic3JjSW5pdGlhdG9ySWQiOiJKRkNaOFFWT0pBNzZOWFo2OEZaRDIxUllJeGozeVBaZGlVeGtkTnVpYkJseGd3YVA0Iiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjaVRyYW5zYWN0aW9uSWQiOiJmOWIyM2Q2NC05YzQ5LTQ1NDctOWM5Mi1lMjliNjQwNTdlMTQiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsiZHBhTG9jYWxlIjoiZW5fVVMiLCJwYXlsb2FkVHlwZUluZGljYXRvciI6IkZVTEwiLCJyZXZpZXdBY3Rpb24iOiJjb250aW51ZSIsImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJDTyJdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IkFMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6IkFMTCIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwiY29uc3VtZXJFbWFpbEFkZHJlc3NSZXF1ZXN0ZWQiOnRydWUsImNvbnN1bWVyUGhvbmVOdW1iZXJSZXF1ZXN0ZWQiOnRydWUsIm1lcmNoYW50Q291bnRyeUNvZGUiOiJVUyIsImN1c3RvbUlucHV0RGF0YSI6eyJjaGVja291dE9yY2hlc3RyYXRvciI6Im1lcmNoYW50In0sInRyYW5zYWN0aW9uQW1vdW50Ijp7InRyYW5zYWN0aW9uQW1vdW50IjoiMjEuMDAiLCJ0cmFuc2FjdGlvbkN1cnJlbmN5Q29kZSI6IlVTRCJ9LCJwYXltZW50T3B0aW9ucyI6eyJkcGFEeW5hbWljRGF0YVR0bE1pbnV0ZXMiOjE1LCJkcGFQYW5SZXF1ZXN0ZWQiOmZhbHNlLCJkeW5hbWljRGF0YVR5cGUiOiJDQVJEX0FQUExJQ0FUSU9OX0NSWVBUT0dSQU1fTE9OR19GT1JNIn19fX0sIlNSQ01BU1RFUkNBUkQiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LnNyYy5tYXN0ZXJjYXJkLmNvbSIsInBhdGgiOiIvc2RrL3NyY3Nkay5tYXN0ZXJjYXJkLmpzIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjIwMjMwMjA3MjIzNTIxLXNhbmRib3gtZnBhbi1lbmNyeXB0aW9uLXNyYy1tYXN0ZXJjYXJkLWludCIsImtleV9vcHMiOlsiZW5jcnlwdCIsIndyYXBLZXkiXSwiYWxnIjoiUlNBLU9BRVAtMjU2IiwibiI6InQwNkk4c2psUy1ycnM3dUNhZ0g4ZXZvZXVtYVJvdkt6aVpTSTlTMk45SURROXRXMlBhcGZSYTlMYzFLdmVFQkRWczI3UGtoa1U1T3lIZ1AwaUVqVHVLVnB2aDU5VDRsYS1tQlNJbHM3VWVjVVFMTGEwV2ttYnRMN2pOZGx0QTVmcTdBaGNBcjVxY2E5ODhxckxkN0l5cjlFMEMzVHhiVDl0bzFpUWNwejhvY1pPRFJYb2lkRkFuT1ZMNVlHRm1sc3JlRGJKNFZoc2kwcEFkY2NRY2lsLXlkU2d1cktCLXJxS3BwYjllcG9tdTRRVWgzMzgyQ3Y4Tm9iWW1GM29zOG5HR2dHUC1jeVhvMG5zS2NQQWdmcmxRem9zN3FIeFVPckZlMnhfbFoxRzFBRS1YcmtyeGpCeXM5cTUzR01SU05DUThjLV9tY0Y5cGJxNEhZQnMtdkQ1USJ9LCJwYXJhbWV0ZXJzIjp7InNyY2lUcmFuc2FjdGlvbklkIjoiZjliMjNkNjQtOWM0OS00NTQ3LTljOTItZTI5YjY0MDU3ZTE0Iiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjSW5pdGlhdG9ySWQiOiI4NDRmN2UzZC0wN2YwLTQ0YjEtYTIzNy1lNjQyNDQ0ZTA1MTIiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsidHJhbnNhY3Rpb25UeXBlIjoiUFVSQ0hBU0UiLCJkcGFMb2NhbGUiOiJlbl9VUyIsImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJDTyJdLCJjb25zdW1lckVtYWlsQWRkcmVzc1JlcXVlc3RlZCI6dHJ1ZSwiY29uc3VtZXJQaG9uZU51bWJlclJlcXVlc3RlZCI6dHJ1ZSwidHJhbnNhY3Rpb25BbW91bnQiOnsidHJhbnNhY3Rpb25BbW91bnQiOiIyMS4wMCIsInRyYW5zYWN0aW9uQ3VycmVuY3lDb2RlIjoiVVNEIn0sImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUJpbGxpbmdQcmVmZXJlbmNlIjoiRlVMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6IkZVTEwiLCJjb25zdW1lck5hbWVSZXF1ZXN0ZWQiOnRydWUsInBheWxvYWRUeXBlSW5kaWNhdG9yIjoiRlVMTCIsInBheW1lbnRPcHRpb25zIjp7ImR5bmFtaWNEYXRhVHlwZSI6IkNBUkRfQVBQTElDQVRJT05fQ1JZUFRPR1JBTV9TSE9SVF9GT1JNIn19fX0sIlNSQ0FNRVgiOnsib3JpZ2luIjoiaHR0cHM6Ly9xd3d3LmFleHAtc3RhdGljLmNvbSIsInBhdGgiOiIvYWthbWFpL3JlbW90ZWNvbW1lcmNlL3NjcmlwdHMvYW1leFNESy0xLjAuMC5qcyIsInBhbkVuY3J5cHRpb25LZXkiOnsia3R5IjoiUlNBIiwiZSI6IkFRQUIiLCJ1c2UiOiJlbmMiLCJraWQiOiJzcmMtYW1leC1jYXJkLWVuYy0yMDI1IiwiYWxnIjoiUlNBLU9BRVAtMjU2IiwibiI6InZNS0IzNkl1a3pvd2pCSVV2LTFDUkxOcjJPcnZoX1NCbU9YV2swUVVJdW0yYmN6cEFFbFBFV3Z0djJRN245SzFhTjh2elloM01ZeUduSDY4YXY0Q1J4b054OFBZVklPZWZOM0hyVU1NUkNzNzRQc2NkcE00TU5VaHBmSF9TVmFsdjNLWUZSRGFaeGZvY2UxRERRVVRkcjRyWFJyOW9XNGlRSVZkX2ZKTkJpTElVN2ZtU0hEZGs3bFZxUWdoYVBMSlhUQzZ4elF6a2phM0FQdm5ma2VYRlV2aVVYNnZ3cW4yYkxDaldnSFZjZDFucktNTmpTMU4yaXdrMFF3WmVuZGx5clRIcGU1NXdhSDhseGdsaVBFTlc1SHpnZDUwUUd6RU1panFCd01VRndFalVidW1rZndSNHZQay1HNUF2U3NCVG5JRWJXWE81WmtqeWltQWYtM09LYjRoYkRFUS14enM4bGpBUE1RT0p5MEI5dXJfOEVfVDhXRHRHODhxcVZkY2xwRlZtSERycWJqc2NUUGNpNGRkQWRxVi1wcHdCczcwNDJjbDNpdEVab05wSjl5cU81T0tzY21jS2pTMUpIbGxlaVlDMjQ4dzVxM1BYWHJfUDNTT2ppdFdsaS1vT2xPdENZSF8ycTBFczZSbndkekNIT1U4WFpPd2tJdmNoUUFEIn0sInBhcmFtZXRlcnMiOnsic3JjaVRyYW5zYWN0aW9uSWQiOiJmOWIyM2Q2NC05YzQ5LTQ1NDctOWM5Mi1lMjliNjQwNTdlMTQiLCJzcmNJbml0aWF0b3JJZCI6IjhlYzJjODg4LTY0Y2MtNGVmYy05MTc1LWIzMzc0NTJiMjhjOCIsImRwYURhdGEiOnsiZHBhTmFtZSI6IkdFVE5FVCBDSElMRSBTLkEuIiwiZHBhTG9nb1VyaSI6Imh0dHBzOi8vd3d3LmdldG5ldC5jbC8iLCJkcGFQcmVzZW50YXRpb25OYW1lIjoiR0VUTkVUIENISUxFIFMuQS4iLCJkcGFVcmkiOiJodHRwczovL3d3dy5nZXRuZXQuY2wvIn0sImRwYVRyYW5zYWN0aW9uT3B0aW9ucyI6eyJkcGFMb2NhbGUiOiJlbl9VUyIsImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJDTyJdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IkFMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6IkFMTCIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwiY29uc3VtZXJFbWFpbEFkZHJlc3NSZXF1ZXN0ZWQiOnRydWUsImNvbnN1bWVyUGhvbmVOdW1iZXJSZXF1ZXN0ZWQiOnRydWUsInJldmlld0FjdGlvbiI6ImNvbnRpbnVlIiwidGhyZWVEc1ByZWZlcmVuY2UiOiJOT05FIn19fX0sImNhcHR1cmVNYW5kYXRlIjp7ImJpbGxpbmdUeXBlIjoiRlVMTCIsInJlcXVlc3RFbWFpbCI6dHJ1ZSwicmVxdWVzdFBob25lIjp0cnVlLCJyZXF1ZXN0U2hpcHBpbmciOnRydWUsInNoaXBUb0NvdW50cmllcyI6WyJVUyIsIkNPIl0sInNob3dBY2NlcHRlZE5ldHdvcmtJY29ucyI6dHJ1ZX0sIm9yZGVySW5mb3JtYXRpb24iOnsiYW1vdW50RGV0YWlscyI6eyJ0b3RhbEFtb3VudCI6IjIxLjAwIiwiY3VycmVuY3kiOiJVU0QifSwiYmlsbFRvIjp7ImFkZHJlc3MxIjoiMTExMSBQYXJrIFN0cmVldCIsImFkZHJlc3MyIjoiQXBhcnRtZW50IDI0QiIsImFkbWluaXN0cmF0aXZlQXJlYSI6Ik5ZIiwiYnVpbGRpbmdOdW1iZXIiOiIxIiwiY291bnRyeSI6IlVTIiwiZGlzdHJpY3QiOiJkaXN0cmljdCIsImxvY2FsaXR5IjoiTmV3IFlvcmsiLCJwb3N0YWxDb2RlIjoiMDAwMDAiLCJjb21wYW55Ijp7ImFkZHJlc3MxIjoiOTAwIE1ldHJvIENlbnRlciBCbHZkIiwiYWRtaW5pc3RyYXRpdmVBcmVhIjoiQ0EiLCJidWlsZGluZ051bWJlciI6IjEiLCJjb3VudHJ5IjoiVVMiLCJkaXN0cmljdCI6ImRpc3RyaWN0IiwibG9jYWxpdHkiOiJGb3N0ZXIgQ2l0eSIsInBvc3RhbENvZGUiOiI5NDQwNCIsIm5hbWUiOiJWaXNhIEluYyJ9LCJlbWFpbCI6Im1heWEudHJhbkBjb21wYW55LmNvbSIsImZpcnN0TmFtZSI6Ik1heWEiLCJsYXN0TmFtZSI6IlRyYW4iLCJtaWRkbGVOYW1lIjoiUyIsInRpdGxlIjoiTXMiLCJwaG9uZU51bWJlciI6IjEyMzQ1Njc4OTAiLCJwaG9uZVR5cGUiOiJwaG9uZVR5cGUifSwic2hpcFRvIjp7ImFkZHJlc3MxIjoiVmlzYSIsImFkZHJlc3MyIjoiMTIzIE1haW4gU3RyZWV0IiwiYWRkcmVzczMiOiJBcGFydG1lbnQgMTAyIiwiYWRtaW5pc3RyYXRpdmVBcmVhIjoiQ0EiLCJidWlsZGluZ051bWJlciI6InN0cmluZyIsImNvdW50cnkiOiJVUyIsImRpc3RyaWN0IjoiZGlzdHJpY3QiLCJsb2NhbGl0eSI6IkZvc3RlciBDaXR5IiwicG9zdGFsQ29kZSI6Ijk0NDA0IiwiZmlyc3ROYW1lIjoiSm9lIiwibGFzdE5hbWUiOiJTb2FwIn19LCJ0YXJnZXRPcmlnaW5zIjpbImh0dHBzOi8vcG9jLWxlbW9uLWZpdmUudmVyY2VsLmFwcCJdLCJpZnJhbWVzIjp7Im1jZSI6Ii9tY2UvbWNlLmh0bWwiLCJidXR0b25zIjoiL2J1dHRvbmxpc3QvYnV0dG9ubGlzdC5odG1sIiwic3JjIjoiL3NlY3VyZS1yZW1vdGUtY29tbWVyY2Uvc3JjLmh0bWwiLCJjdHAiOiIvY3RwL2N0cC5odG1sIiwiZ29vZ2xlcGF5IjoiL2dvb2dsZXBheS9nb29nbGVwYXkuaHRtbCIsImFwcGxlcGF5IjoiL2FwcGxlcGF5L2FwcGxlcGF5Lmh0bWwiLCJwYXplIjoiL3BhemUvcGF6ZS5odG1sIiwiY2hlY2siOiIvY2hlY2svY2hlY2suaHRtbCJ9LCJjbGllbnRWZXJzaW9uIjoiMC4xOSIsImNvdW50cnkiOiJVUyIsImxvY2FsZSI6ImVuX1VTIiwiYWxsb3dlZENhcmROZXR3b3JrcyI6WyJWSVNBIiwiTUFTVEVSQ0FSRCIsIkFNRVgiXSwiY3IiOiI0TW0xU0VvdUs1a3Z4aXdVdzJld3FMX3NIUFlNa29GUVU5OXJGQWFqNVhPMU9rWlQxd1JrOExjSWsweU91U3ZGbUdVWjZrazVPaFRVMnYwc2FxekluaUZ3X3VGelJFNmZJblNZZEFoMGZYbU8wZi0xaWdpcE9EYk8iLCJzZXJ2aWNlT3JpZ2luIjoiaHR0cHM6Ly9hcGl0ZXN0LmN5YmVyc291cmNlLmNvbSIsImNsaWVudExpYnJhcnkiOiJodHRwczovL2FwaXRlc3QuY3liZXJzb3VyY2UuY29tL3VjL3YxL2Fzc2V0cy8wLjE5LjQvU2VjdXJlQWNjZXB0YW5jZS5qcyIsImxvZ2dpbmdQYXRoIjoiL3VjL3YxL2xvZy1ldmVudHMiLCJhc3NldHNQYXRoIjoiL3VjL3YxL2Fzc2V0cy8wLjE5LjQiLCJjbGllbnRMaWJyYXJ5SW50ZWdyaXR5Ijoic2hhMjU2LWZaY3p0Ym90K0w5V2Y0bEQxZTQzRDJkTm4wN0pzNkltSzkyVjU1aWVBeUVcdTAwM2QifSwidHlwZSI6ImdkYS0wLjkuMCJ9XSwiaXNzIjoiRmxleCBBUEkiLCJleHAiOjE3MzQ5ODc2NzMsImlhdCI6MTczNDk4Njc3MywianRpIjoiTEZ2RkJicW9BQnl0cmRlVSJ9.P7zvMeI0cl8KFV54WLtjepR5oof36SogyEgrCxAV9LxZi8ygPpFjbyipqxVHryEXNHW_Yk6EMj3D4QpZyta2WOjOB_SdO-OiM15whFmILd4O4xgoG0ayRrUG1idjNpbqgQQMHO4VshXTOrNFUF2Xm4pEFv1svSpmoO8GT2n3kHzxPx5OMbrrlW8CHpJPfl1pP5mrCcOWblFfx32qqdnkwqtkBhVgnoeC3fB6E6vfdEAK6nD7e87Z23hEaI5kGproq5OBPxdNkXvKKU-Pq5nfPfwMzIsJyBcSKt52cBHh_idJ8KsdOhpRUDNgeG7e-TsqjQl85H8K8KwVd6bShdoqaQ';
  const showArgs = {
    containers: {
      paymentSelection: "#buttonPaymentListContainer"
    }
  };

  Accept(captureContext)
      .then(accept => accept.unifiedPayments())
      .then(up => up.show(showArgs))
      .then(tt => {
        const transientToken = document.getElementById('transientToken');
        transientToken.value = tt;

        console.log('tt:', tt);
      })
      .catch(error => {
        console.error("Error en el flujo de Click to Pay:", error);
      });

  console.log('cargado script de VISA Click to Pay');
};

onMounted(() => {
  console.log('Actualizado el 23 de dic a las 03:46 pm')
  loadVisaClickToPay();
});
</script>
