<template>
  <div>
    <div id="buttonPaymentListContainer"></div>
    <textarea id="transientToken" name="transientToken" rows="25" cols="50"></textarea>
  </div>
</template>

<script setup>
import { onMounted } from 'vue';

const loadVisaClickToPay = async () => {
  console.log('Cargando script de VISA Click to Pay...');
  const script = document.createElement('script');
  script.src = 'https://apitest.cybersource.com/up/v1/assets/0.22.0/SecureAcceptance.js'; // clientLibrary obtenido de la captura de contexto
  script.async = true;
  script.onload = await onVisaClickToPayLoaded;
  script.onerror = function() {
    console.error('Error al cargar el script de VISA Click to Pay.');
  };
  document.head.appendChild(script);
};

const onVisaClickToPayLoaded = async () => {
  const captureContext = 'eyJraWQiOiJ6dSIsImFsZyI6IlJTMjU2In0.eyJmbHgiOnsicGF0aCI6Ii9mbGV4L3YyL3Rva2VucyIsImRhdGEiOiIzeGJONER0eFNTdWllUEpENWxGOVFSQUFFRndRc2dzaGR1YUtSMkZzNkdPckhTMUlDTXhEaWRXYndXOElSUEhNZDBvcll0LzFBYS9kOEIxb0hzL2JqUlpLVjR6U2Mxd0FDSXZ3ZTd6MTZyK1BLMVErdlU5R0hBMVkxcUZRMlVxejRrMHdyNmdaYzZBa0JwbGFoVUdONmhYY1R3XHUwMDNkXHUwMDNkIiwib3JpZ2luIjoiaHR0cHM6Ly90ZXN0ZmxleC5jeWJlcnNvdXJjZS5jb20iLCJ0cmFuc2llbnRUb2tlbk9wZXJhdGlvbnMiOlt7InN1YiI6InRlc3RnZXRuZXRjbF9zYW5kYm94MDAxIiwiYXVkIjoiZ2V0bmV0Y2xfc2FuZGJveCIsImtpZCI6ImUwNDQ5YWU4LTUxZDgtNDQ0MC1iN2IzLWJiODQxYWYzNjIwMiIsInR5cGUiOiJTVE9SRSJ9XSwiandrIjp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwibiI6InR0ck5SVG84VGY1ZmNPdE93SFJrWXB3VXdKTUNwRTRHdzRqbG9EUDU2RVBQQXlubUc5Q0ZqR2stdFhRd0Z2VGk5a08zTHlVbEZxNVFtM2p4TkZ5cEw2czJJRnYwaS1pZ2R4Y0tpQjlhUW9DaE1ISkRWWHBOaXExR1d4d1h1VG4wUWM1ZzdKcnVQZnpFNl9neVh4RVZ2a1N0YmhwSDRfcDV6ckstWjh5ekdsV3lSQWdBdEV4Y2V5NDJJYWdGMEVXVTR3cDRnQ1Y5VkVyRlJpdmIyQ1lEdk1vekRLZ3lyeDBtdnNVOE5wWFYxWHFuYjZ1eUlfemp2WGgwV1NhQm10NFlsVFRyY2NmQ1FMN0hOaUtkWG1XYVlPUlh4bFlvVDdkQzBYekNhNHEtRjdkR3lhZFZnRDR5WHJYYVdaMy1xTmszOHpKSUhKQmJHRzR0Zm9ZTDdLMDFsUSIsImtpZCI6IjA4aFNlTUV3Uk1keWt2dkkxMW9hdFhIMDF3bnZYNXdwIn19LCJjdHgiOlt7ImRhdGEiOnsiYWxsb3dlZFBheW1lbnRUeXBlcyI6W3sicGFnZSI6MSwidHlwZSI6IkNMSUNLVE9QQVkifSx7InBhZ2UiOjIsInR5cGUiOiJTUkNWSVNBIn0seyJwYWdlIjozLCJ0eXBlIjoiU1JDTUFTVEVSQ0FSRCJ9LHsicGFnZSI6NCwidHlwZSI6IlNSQ0FNRVgifSx7InBhZ2UiOjUsInR5cGUiOiJQQU5FTlRSWSJ9XSwicGF5bWVudENvbmZpZ3VyYXRpb25zIjp7IlNSQ1ZJU0EiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LWFzc2V0cy5zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20iLCJwYXRoIjoiL2NoZWNrb3V0LXdpZGdldC9yZXNvdXJjZXMvanMvc3JjLWktYWRhcHRlci92aXNhU2RrLmpzP3YyIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjNHUFdQVkkzRVNXM0dDSlMyWTVGMTNhZVVZbEtUVlRoWGlTMlRLbllLRXRMbC1RRU0iLCJuIjoic1pQSXVzRGY3eVFubmhCa1U5bXUxNFZPTzNDcnVpM2I3ckFmMktZZW9iVVJtWEExN2IxSlg5amcwQ2QtdmdwbXV5VHJ4QlVTYy00YjAtVVBnU3dHRnFQV1VweDA4RXhxcndQRE92Rm9qQm91MndseXE4YmN5MFVzLUJmZUN6U0U1bE1WZFNYVFhYWGNOcXUtcWIyMmpDQ0NKQUxweHNBcnNib01PWHNMZWRoM000WE5RNVhHQXRSZjdiLS11VFk1RHI5S0xZeVV2WktBblkwNE1LSlBFTzU0WWlJRk01RFRBaE5PbXMwODlqZE1keC1VUklLSmpQVTItUnBIRzF1OExDRzAyOFJUSXBQc05iUmFudVM1VEFZX3pseERnYjFoS0ozNlliWkVOSExnOVBYVEJoZE9NbFU5MERUTGxmY2JMVGEtRDdEZ2xqQWFXQ3V2ekxQYUd3In0sInBhcmFtZXRlcnMiOnsic3JjSW5pdGlhdG9ySWQiOiJKRkNaOFFWT0pBNzZOWFo2OEZaRDIxUllJeGozeVBaZGlVeGtkTnVpYkJseGd3YVA0Iiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjaVRyYW5zYWN0aW9uSWQiOiI3MjAwNjQxZS1mY2E1LTRkOTgtYmEzNC04ZDBlYjkwMmIwMWIiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsiZHBhTG9jYWxlIjoiZXNfQ08iLCJwYXlsb2FkVHlwZUluZGljYXRvciI6IkZVTEwiLCJyZXZpZXdBY3Rpb24iOiJjb250aW51ZSIsImRwYUFjY2VwdGVkQmlsbGluZ0NvdW50cmllcyI6W10sImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJHQiJdLCJkcGFCaWxsaW5nUHJlZmVyZW5jZSI6IkFMTCIsImRwYVNoaXBwaW5nUHJlZmVyZW5jZSI6Ik5PTkUiLCJjb25zdW1lck5hbWVSZXF1ZXN0ZWQiOnRydWUsImNvbnN1bWVyRW1haWxBZGRyZXNzUmVxdWVzdGVkIjpmYWxzZSwiY29uc3VtZXJQaG9uZU51bWJlclJlcXVlc3RlZCI6ZmFsc2UsIm1lcmNoYW50Q291bnRyeUNvZGUiOiJDTyIsImN1c3RvbUlucHV0RGF0YSI6eyJjaGVja291dE9yY2hlc3RyYXRvciI6Im1lcmNoYW50In0sInRyYW5zYWN0aW9uQW1vdW50Ijp7InRyYW5zYWN0aW9uQW1vdW50IjoiMjAwMDAiLCJ0cmFuc2FjdGlvbkN1cnJlbmN5Q29kZSI6IkNPUCJ9LCJwYXltZW50T3B0aW9ucyI6eyJkcGFEeW5hbWljRGF0YVR0bE1pbnV0ZXMiOjE1LCJkcGFQYW5SZXF1ZXN0ZWQiOmZhbHNlLCJkeW5hbWljRGF0YVR5cGUiOiJDQVJEX0FQUExJQ0FUSU9OX0NSWVBUT0dSQU1fTE9OR19GT1JNIn19fX0sIlNSQ01BU1RFUkNBUkQiOnsib3JpZ2luIjoiaHR0cHM6Ly9zYW5kYm94LnNyYy5tYXN0ZXJjYXJkLmNvbSIsInBhdGgiOiIvc2RrL3NyY3Nkay5tYXN0ZXJjYXJkLmpzIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6IjIwMjMwMjA3MjIzNTIxLXNhbmRib3gtZnBhbi1lbmNyeXB0aW9uLXNyYy1tYXN0ZXJjYXJkLWludCIsImtleV9vcHMiOlsiZW5jcnlwdCIsIndyYXBLZXkiXSwiYWxnIjoiUlNBLU9BRVAtMjU2IiwibiI6InQwNkk4c2psUy1ycnM3dUNhZ0g4ZXZvZXVtYVJvdkt6aVpTSTlTMk45SURROXRXMlBhcGZSYTlMYzFLdmVFQkRWczI3UGtoa1U1T3lIZ1AwaUVqVHVLVnB2aDU5VDRsYS1tQlNJbHM3VWVjVVFMTGEwV2ttYnRMN2pOZGx0QTVmcTdBaGNBcjVxY2E5ODhxckxkN0l5cjlFMEMzVHhiVDl0bzFpUWNwejhvY1pPRFJYb2lkRkFuT1ZMNVlHRm1sc3JlRGJKNFZoc2kwcEFkY2NRY2lsLXlkU2d1cktCLXJxS3BwYjllcG9tdTRRVWgzMzgyQ3Y4Tm9iWW1GM29zOG5HR2dHUC1jeVhvMG5zS2NQQWdmcmxRem9zN3FIeFVPckZlMnhfbFoxRzFBRS1YcmtyeGpCeXM5cTUzR01SU05DUThjLV9tY0Y5cGJxNEhZQnMtdkQ1USJ9LCJwYXJhbWV0ZXJzIjp7InNyY2lUcmFuc2FjdGlvbklkIjoiNzIwMDY0MWUtZmNhNS00ZDk4LWJhMzQtOGQwZWI5MDJiMDFiIiwic3JjaURwYUlkIjoiYTAxZWUyMGUtYTZlOC00Mjc4LWI0ZGYtOTE1MjJmMzI4ODg3Iiwic3JjSW5pdGlhdG9ySWQiOiI4NDRmN2UzZC0wN2YwLTQ0YjEtYTIzNy1lNjQyNDQ0ZTA1MTIiLCJkcGFUcmFuc2FjdGlvbk9wdGlvbnMiOnsidHJhbnNhY3Rpb25UeXBlIjoiUFVSQ0hBU0UiLCJkcGFMb2NhbGUiOiJlc19DTyIsImRwYUFjY2VwdGVkU2hpcHBpbmdDb3VudHJpZXMiOlsiVVMiLCJHQiJdLCJjb25zdW1lckVtYWlsQWRkcmVzc1JlcXVlc3RlZCI6ZmFsc2UsImNvbnN1bWVyUGhvbmVOdW1iZXJSZXF1ZXN0ZWQiOmZhbHNlLCJ0cmFuc2FjdGlvbkFtb3VudCI6eyJ0cmFuc2FjdGlvbkFtb3VudCI6IjIwMDAwIiwidHJhbnNhY3Rpb25DdXJyZW5jeUNvZGUiOiJDT1AifSwiZHBhQWNjZXB0ZWRCaWxsaW5nQ291bnRyaWVzIjpbXSwiZHBhQmlsbGluZ1ByZWZlcmVuY2UiOiJGVUxMIiwiZHBhU2hpcHBpbmdQcmVmZXJlbmNlIjoiTk9ORSIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwicGF5bG9hZFR5cGVJbmRpY2F0b3IiOiJGVUxMIiwicGF5bWVudE9wdGlvbnMiOnsiZHluYW1pY0RhdGFUeXBlIjoiQ0FSRF9BUFBMSUNBVElPTl9DUllQVE9HUkFNX1NIT1JUX0ZPUk0ifX19fSwiU1JDQU1FWCI6eyJvcmlnaW4iOiJodHRwczovL3F3d3cuYWV4cC1zdGF0aWMuY29tIiwicGF0aCI6Ii9ha2FtYWkvcmVtb3RlY29tbWVyY2Uvc2NyaXB0cy9hbWV4U0RLLTEuMC4wLmpzIiwicGFuRW5jcnlwdGlvbktleSI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsInVzZSI6ImVuYyIsImtpZCI6InNyYy1hbWV4LWNhcmQtZW5jLTIwMjUiLCJhbGciOiJSU0EtT0FFUC0yNTYiLCJuIjoidk1LQjM2SXVrem93akJJVXYtMUNSTE5yMk9ydmhfU0JtT1hXazBRVUl1bTJiY3pwQUVsUEVXdnR2MlE3bjlLMWFOOHZ6WWgzTVl5R25INjhhdjRDUnhvTng4UFlWSU9lZk4zSHJVTU1SQ3M3NFBzY2RwTTRNTlVocGZIX1NWYWx2M0tZRlJEYVp4Zm9jZTFERFFVVGRyNHJYUnI5b1c0aVFJVmRfZkpOQmlMSVU3Zm1TSERkazdsVnFRZ2hhUExKWFRDNnh6UXpramEzQVB2bmZrZVhGVXZpVVg2dndxbjJiTENqV2dIVmNkMW5yS01OalMxTjJpd2swUXdaZW5kbHlyVEhwZTU1d2FIOGx4Z2xpUEVOVzVIemdkNTBRR3pFTWlqcUJ3TVVGd0VqVWJ1bWtmd1I0dlBrLUc1QXZTc0JUbklFYldYTzVaa2p5aW1BZi0zT0tiNGhiREVRLXh6czhsakFQTVFPSnkwQjl1cl84RV9UOFdEdEc4OHFxVmRjbHBGVm1IRHJxYmpzY1RQY2k0ZGRBZHFWLXBwd0JzNzA0MmNsM2l0RVpvTnBKOXlxTzVPS3NjbWNLalMxSkhsbGVpWUMyNDh3NXEzUFhYcl9QM1NPaml0V2xpLW9PbE90Q1lIXzJxMEVzNlJud2R6Q0hPVThYWk93a0l2Y2hRQUQifSwicGFyYW1ldGVycyI6eyJzcmNpVHJhbnNhY3Rpb25JZCI6IjcyMDA2NDFlLWZjYTUtNGQ5OC1iYTM0LThkMGViOTAyYjAxYiIsInNyY0luaXRpYXRvcklkIjoiOGVjMmM4ODgtNjRjYy00ZWZjLTkxNzUtYjMzNzQ1MmIyOGM4IiwiZHBhRGF0YSI6eyJkcGFOYW1lIjoiR0VUTkVUIENISUxFIFMuQS4iLCJkcGFMb2dvVXJpIjoiaHR0cHM6Ly93d3cuZ2V0bmV0LmNsLyIsImRwYVByZXNlbnRhdGlvbk5hbWUiOiJHRVRORVQgQ0hJTEUgUy5BLiIsImRwYVVyaSI6Imh0dHBzOi8vd3d3LmdldG5ldC5jbC8ifSwiZHBhVHJhbnNhY3Rpb25PcHRpb25zIjp7ImRwYUxvY2FsZSI6ImVzX0NPIiwiZHBhQWNjZXB0ZWRCaWxsaW5nQ291bnRyaWVzIjpbXSwiZHBhQWNjZXB0ZWRTaGlwcGluZ0NvdW50cmllcyI6WyJVUyIsIkdCIl0sImRwYUJpbGxpbmdQcmVmZXJlbmNlIjoiQUxMIiwiZHBhU2hpcHBpbmdQcmVmZXJlbmNlIjoiTk9ORSIsImNvbnN1bWVyTmFtZVJlcXVlc3RlZCI6dHJ1ZSwiY29uc3VtZXJFbWFpbEFkZHJlc3NSZXF1ZXN0ZWQiOmZhbHNlLCJjb25zdW1lclBob25lTnVtYmVyUmVxdWVzdGVkIjpmYWxzZSwicmV2aWV3QWN0aW9uIjoiY29udGludWUiLCJ0aHJlZURzUHJlZmVyZW5jZSI6Ik5PTkUifX19fSwiY2FwdHVyZU1hbmRhdGUiOnsiYmlsbGluZ1R5cGUiOiJGVUxMIiwicmVxdWVzdEVtYWlsIjpmYWxzZSwicmVxdWVzdFBob25lIjpmYWxzZSwicmVxdWVzdFNoaXBwaW5nIjpmYWxzZSwic2hpcFRvQ291bnRyaWVzIjpbIlVTIiwiR0IiXSwic2hvd0FjY2VwdGVkTmV0d29ya0ljb25zIjpmYWxzZX0sIm9yZGVySW5mb3JtYXRpb24iOnsiYW1vdW50RGV0YWlscyI6eyJ0b3RhbEFtb3VudCI6IjIwMDAwIiwiY3VycmVuY3kiOiJDT1AifSwiYmlsbFRvIjp7ImFkZHJlc3MxIjoiOTAwIE1ldHJvIENlbnRlciBCbHZkIiwiYWRtaW5pc3RyYXRpdmVBcmVhIjoiQ0EiLCJidWlsZGluZ051bWJlciI6IjEiLCJjb3VudHJ5IjoiVVMiLCJkaXN0cmljdCI6ImRpc3RyaWN0IiwibG9jYWxpdHkiOiJGb3N0ZXIgQ2l0eSIsInBvc3RhbENvZGUiOiI5NDQwNCIsImVtYWlsIjoianVhbnBhcGFib25AZ21haWwuY29tIiwiZmlyc3ROYW1lIjoiTWF5YSIsImxhc3ROYW1lIjoiVHJhbiIsIm1pZGRsZU5hbWUiOiJTIiwidGl0bGUiOiJNcyIsInBob25lTnVtYmVyIjoiMzAwNjcxOTIzNSIsInBob25lVHlwZSI6InBob25lVHlwZSJ9fSwidGFyZ2V0T3JpZ2lucyI6WyJodHRwczovL3BvYy1sZW1vbi1maXZlLnZlcmNlbC5hcHAiXSwiaWZyYW1lcyI6eyJtY2UiOiIvbWNlL21jZS5odG1sIiwiYnV0dG9ucyI6Ii9idXR0b25saXN0L2J1dHRvbmxpc3QuaHRtbCIsInNyYyI6Ii9zZWN1cmUtcmVtb3RlLWNvbW1lcmNlL3NyYy5odG1sIiwiY3RwIjoiL2N0cC9jdHAuaHRtbCIsImdvb2dsZXBheSI6Ii9nb29nbGVwYXkvZ29vZ2xlcGF5Lmh0bWwiLCJhcHBsZXBheSI6Ii9hcHBsZXBheS9hcHBsZXBheS5odG1sIiwicGF6ZSI6Ii9wYXplL3BhemUuaHRtbCIsImNoZWNrIjoiL2NoZWNrL2NoZWNrLmh0bWwifSwiY2xpZW50VmVyc2lvbiI6IjAuMjIiLCJjb3VudHJ5IjoiQ08iLCJsb2NhbGUiOiJlc19DTyIsImFsbG93ZWRDYXJkTmV0d29ya3MiOlsiVklTQSIsIk1BU1RFUkNBUkQiLCJBTUVYIl0sImNyIjoiQjlXSWFORVdWQi1zR19iOXQ2YVlPX2RjZlVidF9kMmdvOWhyV2JhXzhGY2NnTDYwLTZyUnBaMHVRam1ZRjI3bTdtNzFRNFdWQmtWUF8tbE1uV0ZFWWJmUzdfclk1c3R5NlJOV1FQT0hYOGN0UUNwUkppeTZncE5RIiwic2VydmljZU9yaWdpbiI6Imh0dHBzOi8vYXBpdGVzdC5jeWJlcnNvdXJjZS5jb20iLCJjbGllbnRMaWJyYXJ5IjoiaHR0cHM6Ly9hcGl0ZXN0LmN5YmVyc291cmNlLmNvbS91Yy92MS9hc3NldHMvMC4yMi40L1NlY3VyZUFjY2VwdGFuY2UuanMiLCJsb2dnaW5nUGF0aCI6Ii91Yy92MS9sb2ctZXZlbnRzIiwiYXNzZXRzUGF0aCI6Ii91Yy92MS9hc3NldHMvMC4yMi40IiwiY2xpZW50TGlicmFyeUludGVncml0eSI6InNoYTI1Ni10M2tXcXJxS3BXQWJINUNDVDhkNy94TG1keEw4aG1zSlF3R0VLdWsxckRvXHUwMDNkIn0sInR5cGUiOiJnZGEtMC45LjAifV0sImlzcyI6IkZsZXggQVBJIiwiZXhwIjoxNzM0OTg2MDMyLCJpYXQiOjE3MzQ5ODUxMzIsImp0aSI6ImtMeGZMOWQ0VGFUVnlud24ifQ.k2I-95J_Dgf56jYTlEKgQ9imegNRiqB0z8KM1z1BITfmLkI7hiS39G3e0InUS5DUw4PxQbb8Z1Wtkc5W3D--JPW-GsRqS3HOUF-Knvj_AkPSMQvKvie3YYJdUTNn1FwU_BfkM_DtWMs6mzV9x_Cv0pKDpcgj1BTj6uKIGerVd9NTTxlo2XtkHAhXXnFfKuTfaHWOUTu7mM5nnR9kEhYvgH9ijo2JBv5OR4cxsUa8SQbpQKQn4rFs05iNwKliJGHV0R4MaTHRRlBSUEVOEtgZbsfsbQw42SmUSy0pObjA4WUIzXp7GeUkVKpmgqd4-DrQMVdxUXMlXlpUKJGoVpleNQ';
  const showArgs = {
    containers: {
      paymentSelection: "#buttonPaymentListContainer"
    }
  };

  Accept(captureContext)
      .then(accept => accept.unifiedPayments())
      .then(up => up.show(showArgs))
      .then(tt => {
        const transientToken = document.getElementById('transientToken');
        transientToken.value = tt;

        console.log('tt:', tt);
      })
      .catch(error => {
        console.error("Error en el flujo de Click to Pay:", error);
      });

  console.log('cargado script de VISA Click to Pay');
};

onMounted(() => {
  console.log('Actualizado el 23 de dic a las 03:19 pm')
  loadVisaClickToPay();
});
</script>
